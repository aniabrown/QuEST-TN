<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Exact Simulation Toolkit: QuEST_tn.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quantum Exact Simulation Toolkit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_43e0a1f539e00dcfa1a6bc4d4fee4fc2.html">home</a></li><li class="navelem"><a class="el" href="dir_8ae12c0f030e269d6ff542b3c3105a2c.html">ania</a></li><li class="navelem"><a class="el" href="dir_76d8ae1525f7f128f3576c1c2bb27bae.html">Documents</a></li><li class="navelem"><a class="el" href="dir_c9583ccc1263fb3720e00a8c946d9d46.html">no_sync</a></li><li class="navelem"><a class="el" href="dir_339c8b083f7b8e3a80a541920a47a31f.html">git_QuEST-TN</a></li><li class="navelem"><a class="el" href="dir_b16590c90928eee0254f9005564191c1.html">TN</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">QuEST_tn.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;QuEST.h&gt;</code><br />
<code>#include &quot;QuEST_debug.h&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__tn__internal_8h_source.html">QuEST_tn_internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__tn_8h_source.html">QuEST_tn.h</a>&quot;</code><br />
</div>
<p><a href="QuEST__tn_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad72dbcf6d0153db1b8d8a58001feed83"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ad72dbcf6d0153db1b8d8a58001feed83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6551f0b4c3964c3128f808e7bf987c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>(x)&#160;&#160;&#160;do {} while (0)</td></tr>
<tr class="separator:af6551f0b4c3964c3128f808e7bf987c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9bddda7801050a3a3feceabe977ce2ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a9bddda7801050a3a3feceabe977ce2ea">contractTensorNetwork</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, QuESTEnv env)</td></tr>
<tr class="memdesc:a9bddda7801050a3a3feceabe977ce2ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contract all tensors in a tensor network one by one.  <a href="#a9bddda7801050a3a3feceabe977ce2ea">More...</a><br /></td></tr>
<tr class="separator:a9bddda7801050a3a3feceabe977ce2ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb7fb87ab056b361cd2007bbea77f2d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#adb7fb87ab056b361cd2007bbea77f2d5">contractTensors</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, int tensor1Index, int tensor2Index, QuESTEnv env)</td></tr>
<tr class="memdesc:adb7fb87ab056b361cd2007bbea77f2d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces the tensor object at index tensor1 in the tensor network with the contraction of tensor1 and tensor 2.  <a href="#adb7fb87ab056b361cd2007bbea77f2d5">More...</a><br /></td></tr>
<tr class="separator:adb7fb87ab056b361cd2007bbea77f2d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb46e2a13b03f3dc171437eec5e54a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a8eb46e2a13b03f3dc171437eec5e54a5">createTensorNetwork</a> (int numTensors, int *numPqPerTensor, int *numVqPerTensor, QuESTEnv env)</td></tr>
<tr class="memdesc:a8eb46e2a13b03f3dc171437eec5e54a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for and initialize a new tensor network object given the number of physical qubits and maximum number of virtual qubits in each tensor.  <a href="#a8eb46e2a13b03f3dc171437eec5e54a5">More...</a><br /></td></tr>
<tr class="separator:a8eb46e2a13b03f3dc171437eec5e54a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01f5c813a7b9f00287fa5424284fcc9"><td class="memItemLeft" align="right" valign="top">long long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#af01f5c813a7b9f00287fa5424284fcc9">getContractedIndex</a> (long long int activeStateVec1Index, long long int activeStateVec2Index, long long int stateVec1PhysicalSize, long long int stateVec2PhysicalSize, int numTensor1Pq, int numTensor2Pq, int numTensor1UncontractedVqs, int numTensor2UncontractedVqs)</td></tr>
<tr class="memdesc:af01f5c813a7b9f00287fa5424284fcc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the index in the output state vector where an element resulting from a contraction between two tensors should be placed.  <a href="#af01f5c813a7b9f00287fa5424284fcc9">More...</a><br /></td></tr>
<tr class="separator:af01f5c813a7b9f00287fa5424284fcc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f0d16ecbd39a662bb17b21a6ba15d1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a0f0d16ecbd39a662bb17b21a6ba15d1b">getContractionVqIndices</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, int tensor1Index, int tensor2Index, int numContractions, int **tensor1Contractions, int **tensor2Contractions, int *numTensor1UncontractedVqs, int *numTensor2UncontractedVqs, int **tensor1UncontractedVqs, int **tensor2UncontractedVqs)</td></tr>
<tr class="memdesc:a0f0d16ecbd39a662bb17b21a6ba15d1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">For a particular contraction of two tensors, generate the lists of virtual qubits that will be contracted and that will remain uncontracted for each tensor.  <a href="#a0f0d16ecbd39a662bb17b21a6ba15d1b">More...</a><br /></td></tr>
<tr class="separator:a0f0d16ecbd39a662bb17b21a6ba15d1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6ac2be8a3e7da5fc5855a3b0b0656b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structQCoord.html">QCoord</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#ac6ac2be8a3e7da5fc5855a3b0b0656b7">getLocalPq</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, int globalPq)</td></tr>
<tr class="separator:ac6ac2be8a3e7da5fc5855a3b0b0656b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47c52a5805c348ef8517b3d91a760cdd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a47c52a5805c348ef8517b3d91a760cdd">getNumContractions</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, int tensor1Index, int tensor2Index)</td></tr>
<tr class="memdesc:a47c52a5805c348ef8517b3d91a760cdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of indices that will be contracted over when the two input tensors are contracted.  <a href="#a47c52a5805c348ef8517b3d91a760cdd">More...</a><br /></td></tr>
<tr class="separator:a47c52a5805c348ef8517b3d91a760cdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3392b1ff25fb2f1f60cc7af272659b11"><td class="memItemLeft" align="right" valign="top">long long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a3392b1ff25fb2f1f60cc7af272659b11">getStateVectorIndexFromActiveIndex</a> (long long int activeStateIndex, int numPq, int *uncontractedVqs, int numUncontractedVqs)</td></tr>
<tr class="separator:a3392b1ff25fb2f1f60cc7af272659b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af429a9a3a19a3c1b0f11a09326b5846f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#af429a9a3a19a3c1b0f11a09326b5846f">getVqVertexIndex</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, <a class="el" href="structVqVertex.html">VqVertex</a> *vqVertex)</td></tr>
<tr class="separator:af429a9a3a19a3c1b0f11a09326b5846f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a502a2f31cd89e3e8ad3148f2de2ac346"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a502a2f31cd89e3e8ad3148f2de2ac346">initVirtualControl</a> (<a class="el" href="structTensor.html">Tensor</a> tensor, int vqIndex)</td></tr>
<tr class="separator:a502a2f31cd89e3e8ad3148f2de2ac346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac981843cd91f909690681de3eb5e8a64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#ac981843cd91f909690681de3eb5e8a64">initVirtualTarget</a> (<a class="el" href="structTensor.html">Tensor</a> tensor, int vqIndex)</td></tr>
<tr class="separator:ac981843cd91f909690681de3eb5e8a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25f06328d45b2f509185b89773c9163e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a25f06328d45b2f509185b89773c9163e">printTensorNetwork</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn)</td></tr>
<tr class="memdesc:a25f06328d45b2f509185b89773c9163e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print all tensors in a tensor network and their entanglement with other tensors.  <a href="#a25f06328d45b2f509185b89773c9163e">More...</a><br /></td></tr>
<tr class="separator:a25f06328d45b2f509185b89773c9163e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a629ac80385cf6ba6b9067a99d23b9946"><td class="memItemLeft" align="right" valign="top">Complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a629ac80385cf6ba6b9067a99d23b9946">recursiveContract</a> (<a class="el" href="structTensor.html">Tensor</a> tensor1, <a class="el" href="structTensor.html">Tensor</a> tensor2, long long int tensor1Offset, long long int tensor2Offset, int *tensor1Contractions, int *tensor2Contractions, int numContractions, int vqIndex)</td></tr>
<tr class="separator:a629ac80385cf6ba6b9067a99d23b9946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64f43b029eab36c891ccba576b009914"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a64f43b029eab36c891ccba576b009914">remapFirstGlobalPqIndex</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn)</td></tr>
<tr class="separator:a64f43b029eab36c891ccba576b009914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d832a151f2596273ed4fcda5634ee53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a1d832a151f2596273ed4fcda5634ee53">remapTensorIndexFromGlobalPq</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn)</td></tr>
<tr class="separator:a1d832a151f2596273ed4fcda5634ee53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84bbb3abdea1ae82b3c2ce2950bc445d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a84bbb3abdea1ae82b3c2ce2950bc445d">removeAllVqVertices</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, int tensorIndex)</td></tr>
<tr class="separator:a84bbb3abdea1ae82b3c2ce2950bc445d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d0a76659767015c051ffc959e723693"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#a4d0a76659767015c051ffc959e723693">removeContractedVqVertices</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, int tensorIndex, int newTensorIndex, <a class="el" href="structVqVertex.html">VqVertex</a> *startingVqVertex, <a class="el" href="structVqVertex.html">VqVertex</a> *prevVqVertexToKeep, int *uncontractedVqs, int numUncontractedVqs, <a class="el" href="structVqVertex.html">VqVertex</a> **tail, int *foundHead)</td></tr>
<tr class="separator:a4d0a76659767015c051ffc959e723693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac72c327e053be69896f5660f5655e59c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8c.html#ac72c327e053be69896f5660f5655e59c">tn_controlledNot</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, const int controlQubit, const int targetQubit)</td></tr>
<tr class="memdesc:ac72c327e053be69896f5660f5655e59c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate on qubits in a tensor network.  <a href="#ac72c327e053be69896f5660f5655e59c">More...</a><br /></td></tr>
<tr class="separator:ac72c327e053be69896f5660f5655e59c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad72dbcf6d0153db1b8d8a58001feed83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72dbcf6d0153db1b8d8a58001feed83">&#9670;&nbsp;</a></span>DEBUG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00008">8</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

</div>
</div>
<a id="af6551f0b4c3964c3128f808e7bf987c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6551f0b4c3964c3128f808e7bf987c7">&#9670;&nbsp;</a></span>DEBUG_PRINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_PRINT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;do {} while (0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00013">13</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00128">getContractedIndex()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00202">recursiveContract()</a>, and <a class="el" href="QuEST__tn_8c_source.html#l00549">tn_controlledNot()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9bddda7801050a3a3feceabe977ce2ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bddda7801050a3a3feceabe977ce2ea">&#9670;&nbsp;</a></span>contractTensorNetwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void contractTensorNetwork </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuESTEnv&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Contract all tensors in a tensor network one by one. </p>
<p>The simplest strategy &ndash; contract tensor 0 with every other tensor in turn Output will be stored as tensor 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn tensor network to contract </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">QuESTEnv</td><td>env QuEST environment object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00024">24</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00050">TensorNetwork::numTensors</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                                                          {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a>; i++){</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="QuEST__tn_8c.html#adb7fb87ab056b361cd2007bbea77f2d5">contractTensors</a>(tn, 0, i, env);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div><div class="ttc" id="QuEST__tn_8c_html_adb7fb87ab056b361cd2007bbea77f2d5"><div class="ttname"><a href="QuEST__tn_8c.html#adb7fb87ab056b361cd2007bbea77f2d5">contractTensors</a></div><div class="ttdeci">void contractTensors(TensorNetwork tn, int tensor1Index, int tensor2Index, QuESTEnv env)</div><div class="ttdoc">Replaces the tensor object at index tensor1 in the tensor network with the contraction of tensor1 and...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00269">QuEST_tn.c:269</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad46c386a71fed70e88cfa327871eaa90"><div class="ttname"><a href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">TensorNetwork::numTensors</a></div><div class="ttdeci">int numTensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00050">QuEST_tn.h:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb7fb87ab056b361cd2007bbea77f2d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb7fb87ab056b361cd2007bbea77f2d5">&#9670;&nbsp;</a></span>contractTensors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void contractTensors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensor1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensor2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuESTEnv&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Replaces the tensor object at index tensor1 in the tensor network with the contraction of tensor1 and tensor 2. </p>
<p>All virtual qubits linking the two tensors are contracted in this operation. There may be virtual qubits left over after the contraction, corresponding to entanglement with other tensors in the network.</p>
<p>The ordering of qubits in the output tensor from lowest to highest is as follows: tensor1 physical qubits, tensor2 physical qubits, tensor1 virtual qubits, tensor2 virtual qubits.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn the tensor network the two tensors belong to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>tensor1 the index of the first tensor to contract </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>tensor1 the index of the second tensor to contract </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">QuESTEnv</td><td>env the QuEST environment object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00269">269</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8c_source.html#l00013">DEBUG_PRINT</a>, <a class="el" href="QuEST__tn_8c_source.html#l00128">getContractedIndex()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00074">getContractionVqIndices()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00041">getNumContractions()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00179">getStateVectorIndexFromActiveIndex()</a>, <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00046">Tensor::nextVqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00044">Tensor::numVq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00042">Tensor::qureg</a>, <a class="el" href="QuEST__tn_8c_source.html#l00202">recursiveContract()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00482">remapFirstGlobalPqIndex()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00471">remapTensorIndexFromGlobalPq()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00501">removeContractedVqVertices()</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00054">TensorNetwork::tensorTailVqVertex</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00024">contractTensorNetwork()</a>, and <a class="el" href="testCircuit1_8c_source.html#l00006">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                                                                        {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// always store new tensor in the smaller tensor index</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (tensor2Index &lt; tensor1Index){</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordtype">int</span> tensorIndexTmp = tensor1Index;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        tensor1Index = tensor2Index;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        tensor2Index = tensorIndexTmp;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> tensor1 = tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor1Index];</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> tensor2 = tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor2Index]; </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> outputTensor;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">int</span> numContractions = <a class="code" href="QuEST__tn_8c.html#a47c52a5805c348ef8517b3d91a760cdd">getNumContractions</a>(tn, tensor1Index, tensor2Index);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;numContractions: %d\n&quot;</span>, numContractions));</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">int</span> *tensor1Contractions, *tensor2Contractions; </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">int</span> *tensor1UncontractedVqs, *tensor2UncontractedVqs; </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">int</span> numTensor1UncontractedVqs=0, numTensor2UncontractedVqs=0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="QuEST__tn_8c.html#a0f0d16ecbd39a662bb17b21a6ba15d1b">getContractionVqIndices</a>(tn, tensor1Index, tensor2Index, numContractions, </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            &amp;tensor1Contractions, &amp;tensor2Contractions,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            &amp;numTensor1UncontractedVqs, &amp;numTensor2UncontractedVqs,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            &amp;tensor1UncontractedVqs, &amp;tensor2UncontractedVqs);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;tensor1Contractions: &quot;</span>));</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=0; p&lt;numContractions; p++) {<a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;%d &quot;</span>, tensor1Contractions[p])); }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;\ntensor2Contractions: &quot;</span>));</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=0; p&lt;numContractions; p++) {<a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;%d &quot;</span>, tensor2Contractions[p])); }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;\ntensor1UncontractedVqs: &quot;</span>));</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=0; p&lt;numTensor1UncontractedVqs; p++) {<a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;%d &quot;</span>, tensor1UncontractedVqs[p])); }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;\ntensor2UncontractedVqs: &quot;</span>));</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=0; p&lt;numTensor2UncontractedVqs; p++) {<a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;%d &quot;</span>, tensor2UncontractedVqs[p])); }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;\n&quot;</span>));</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">int</span> totalNumPq = tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> + tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">int</span> totalNumVq = numTensor1UncontractedVqs + numTensor2UncontractedVqs;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">int</span> totalNumQ = totalNumPq + totalNumVq;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> contractedStateVecSize, stateVec1Size, stateVec2Size, activeStateVec1Size, activeStateVec2Size;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> contractedIndex, stateVec1Index, stateVec2Index, activeStateVec1Index, activeStateVec2Index;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVec1PhysicalSize, stateVec2PhysicalSize;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    contractedStateVecSize = 1LL &lt;&lt; totalNumQ;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    stateVec1Size = 1LL &lt;&lt; tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> + tensor1.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    stateVec2Size = 1LL &lt;&lt; tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> + tensor1.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    stateVec1PhysicalSize = 1LL &lt;&lt; tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    stateVec2PhysicalSize = 1LL &lt;&lt; tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    activeStateVec1Size = stateVec1Size &gt;&gt; numContractions;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    activeStateVec2Size = stateVec2Size &gt;&gt; numContractions;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    Qureg contractedQureg = createQureg(totalNumQ, env);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    Qureg qureg1 = tensor1.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    Qureg qureg2 = tensor2.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    qreal sumReal, sumImag;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    qreal *stateVec1Real = qureg1.stateVec.real;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    qreal *stateVec1Imag = qureg1.stateVec.imag;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    qreal *stateVec2Real = qureg2.stateVec.real;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    qreal *stateVec2Imag = qureg2.stateVec.imag;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">for</span> (activeStateVec2Index=0; activeStateVec2Index&lt;activeStateVec2Size; activeStateVec2Index++) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">for</span> (activeStateVec1Index=0; activeStateVec1Index&lt;activeStateVec1Size; activeStateVec1Index++) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            stateVec1Index = <a class="code" href="QuEST__tn_8c.html#a3392b1ff25fb2f1f60cc7af272659b11">getStateVectorIndexFromActiveIndex</a>(activeStateVec1Index, tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    tensor1UncontractedVqs, numTensor1UncontractedVqs);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            stateVec2Index = <a class="code" href="QuEST__tn_8c.html#a3392b1ff25fb2f1f60cc7af272659b11">getStateVectorIndexFromActiveIndex</a>(activeStateVec2Index, tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    tensor2UncontractedVqs, numTensor2UncontractedVqs);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;-------------------------\n&quot;</span>));</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;t1: ai %lld si %lld\n&quot;</span>, activeStateVec1Index, stateVec1Index));</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;t2: ai %lld si %lld\n&quot;</span>, activeStateVec2Index, stateVec2Index));</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            Complex sum;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            sum = <a class="code" href="QuEST__tn_8c.html#a629ac80385cf6ba6b9067a99d23b9946">recursiveContract</a>(tensor1, tensor2, stateVec1Index, stateVec2Index, </div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                tensor1Contractions, tensor2Contractions, numContractions, 0);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            contractedIndex = <a class="code" href="QuEST__tn_8c.html#af01f5c813a7b9f00287fa5424284fcc9">getContractedIndex</a>(activeStateVec1Index, activeStateVec2Index, </div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    stateVec1PhysicalSize, stateVec2PhysicalSize, tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>, tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    numTensor1UncontractedVqs, numTensor2UncontractedVqs);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;OUTPUT: %lld VALUE: %f\n&quot;</span>, contractedIndex, sum.real));</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            contractedQureg.stateVec.real[contractedIndex] = sum.real;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            contractedQureg.stateVec.imag[contractedIndex] = sum.imag;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// Update vqVertices in tn lists</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    </div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// first tensor&#39;s vqVertices</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="structVqVertex.html">VqVertex</a> *tail=NULL;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">int</span> foundHead=0;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="QuEST__tn_8c.html#a4d0a76659767015c051ffc959e723693">removeContractedVqVertices</a>(tn, tensor1Index, tensor1Index, tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor1Index],</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            NULL, tensor1UncontractedVqs, numTensor1UncontractedVqs, &amp;tail, &amp;foundHead);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// second tensor&#39;s vqVertices</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (foundHead){</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">// there was at least one uncontracted index in the first tensor</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        tail-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor2Index];</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="QuEST__tn_8c.html#a4d0a76659767015c051ffc959e723693">removeContractedVqVertices</a>(tn, tensor2Index, tensor1Index, tail-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>, tail,</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                tensor2UncontractedVqs, numTensor2UncontractedVqs, &amp;tail, &amp;foundHead);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">// there were no uncontracted index in the first tensor</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="QuEST__tn_8c.html#a4d0a76659767015c051ffc959e723693">removeContractedVqVertices</a>(tn, tensor2Index, tensor1Index, tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor2Index], </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                NULL, tensor2UncontractedVqs, numTensor2UncontractedVqs, &amp;tail, &amp;foundHead);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> (!foundHead) tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor1Index] = NULL;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[tensor1Index] = tail;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (tail != NULL) tail-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = NULL;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   </div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// Update first tensor </span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// The output of the contraction is stored in the location of the first tensor </span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// in the tensor array.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    destroyQureg(tensor1.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, env);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    outputTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a> = contractedQureg;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    outputTensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> = totalNumPq;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    outputTensor.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a> = totalNumVq;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    outputTensor.<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> = totalNumVq;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[tensor1Index] = totalNumVq;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor1Index] = outputTensor;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    </div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// Update second tensor</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// The order of tensors in the tensor array is not changed when two tensors are contracted</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// -- for now, just leave a gap where the second tensor was by setting numPq to 0.</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    destroyQureg(tensor2.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, env);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor2Index].<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> = 0;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor2Index].<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a> = 0;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// Update tn mapping between global qubit indices and (tensor, local qubit index)</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="QuEST__tn_8c.html#a1d832a151f2596273ed4fcda5634ee53">remapTensorIndexFromGlobalPq</a>(tn);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="QuEST__tn_8c.html#a64f43b029eab36c891ccba576b009914">remapFirstGlobalPqIndex</a>(tn);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    </div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div><div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_af6551f0b4c3964c3128f808e7bf987c7"><div class="ttname"><a href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a></div><div class="ttdeci">#define DEBUG_PRINT(x)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00013">QuEST_tn.c:13</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a0f0d16ecbd39a662bb17b21a6ba15d1b"><div class="ttname"><a href="QuEST__tn_8c.html#a0f0d16ecbd39a662bb17b21a6ba15d1b">getContractionVqIndices</a></div><div class="ttdeci">void getContractionVqIndices(TensorNetwork tn, int tensor1Index, int tensor2Index, int numContractions, int **tensor1Contractions, int **tensor2Contractions, int *numTensor1UncontractedVqs, int *numTensor2UncontractedVqs, int **tensor1UncontractedVqs, int **tensor2UncontractedVqs)</div><div class="ttdoc">For a particular contraction of two tensors, generate the lists of virtual qubits that will be contra...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00074">QuEST_tn.c:74</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a47c52a5805c348ef8517b3d91a760cdd"><div class="ttname"><a href="QuEST__tn_8c.html#a47c52a5805c348ef8517b3d91a760cdd">getNumContractions</a></div><div class="ttdeci">int getNumContractions(TensorNetwork tn, int tensor1Index, int tensor2Index)</div><div class="ttdoc">Get the number of indices that will be contracted over when the two input tensors are contracted...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00041">QuEST_tn.c:41</a></div></div>
<div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a64f43b029eab36c891ccba576b009914"><div class="ttname"><a href="QuEST__tn_8c.html#a64f43b029eab36c891ccba576b009914">remapFirstGlobalPqIndex</a></div><div class="ttdeci">void remapFirstGlobalPqIndex(TensorNetwork tn)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00482">QuEST_tn.c:482</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a3392b1ff25fb2f1f60cc7af272659b11"><div class="ttname"><a href="QuEST__tn_8c.html#a3392b1ff25fb2f1f60cc7af272659b11">getStateVectorIndexFromActiveIndex</a></div><div class="ttdeci">long long int getStateVectorIndexFromActiveIndex(long long int activeStateIndex, int numPq, int *uncontractedVqs, int numUncontractedVqs)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00179">QuEST_tn.c:179</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="structTensor_html_aae8329bae4c7f141f77d5449617e3ce0"><div class="ttname"><a href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">Tensor::nextVqIndex</a></div><div class="ttdeci">int nextVqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00046">QuEST_tn.h:46</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structTensor_html_ab69644f02f0c6aad5483931e82d2fdd2"><div class="ttname"><a href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">Tensor::numVq</a></div><div class="ttdeci">int numVq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00044">QuEST_tn.h:44</a></div></div>
<div class="ttc" id="structTensorNetwork_html_af572173bbbd5831bafac1563fb42af61"><div class="ttname"><a href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">TensorNetwork::tensorTailVqVertex</a></div><div class="ttdeci">VqVertex ** tensorTailVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00054">QuEST_tn.h:54</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_af01f5c813a7b9f00287fa5424284fcc9"><div class="ttname"><a href="QuEST__tn_8c.html#af01f5c813a7b9f00287fa5424284fcc9">getContractedIndex</a></div><div class="ttdeci">long long int getContractedIndex(long long int activeStateVec1Index, long long int activeStateVec2Index, long long int stateVec1PhysicalSize, long long int stateVec2PhysicalSize, int numTensor1Pq, int numTensor2Pq, int numTensor1UncontractedVqs, int numTensor2UncontractedVqs)</div><div class="ttdoc">Get the index in the output state vector where an element resulting from a contraction between two te...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00128">QuEST_tn.c:128</a></div></div>
<div class="ttc" id="structTensor_html_a882c9fd399f54814efe79340fb90f23e"><div class="ttname"><a href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">Tensor::qureg</a></div><div class="ttdeci">Qureg qureg</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00042">QuEST_tn.h:42</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a4d0a76659767015c051ffc959e723693"><div class="ttname"><a href="QuEST__tn_8c.html#a4d0a76659767015c051ffc959e723693">removeContractedVqVertices</a></div><div class="ttdeci">void removeContractedVqVertices(TensorNetwork tn, int tensorIndex, int newTensorIndex, VqVertex *startingVqVertex, VqVertex *prevVqVertexToKeep, int *uncontractedVqs, int numUncontractedVqs, VqVertex **tail, int *foundHead)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00501">QuEST_tn.c:501</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a629ac80385cf6ba6b9067a99d23b9946"><div class="ttname"><a href="QuEST__tn_8c.html#a629ac80385cf6ba6b9067a99d23b9946">recursiveContract</a></div><div class="ttdeci">Complex recursiveContract(Tensor tensor1, Tensor tensor2, long long int tensor1Offset, long long int tensor2Offset, int *tensor1Contractions, int *tensor2Contractions, int numContractions, int vqIndex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00202">QuEST_tn.c:202</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a1d832a151f2596273ed4fcda5634ee53"><div class="ttname"><a href="QuEST__tn_8c.html#a1d832a151f2596273ed4fcda5634ee53">remapTensorIndexFromGlobalPq</a></div><div class="ttdeci">void remapTensorIndexFromGlobalPq(TensorNetwork tn)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00471">QuEST_tn.c:471</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8eb46e2a13b03f3dc171437eec5e54a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eb46e2a13b03f3dc171437eec5e54a5">&#9670;&nbsp;</a></span>createTensorNetwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a> createTensorNetwork </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numTensors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numPqPerTensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numVqPerTensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuESTEnv&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory for and initialize a new tensor network object given the number of physical qubits and maximum number of virtual qubits in each tensor. </p>
<p>Initialise all physical qubits to the zero state and virtual qubits to an undefined state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>numTensors the number of tensors in the tensor network </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int*</td><td>numPqPerTensor an array of values corresponding to the number of physical qubits in each tensor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int*</td><td>numVqPerTensor an array of values corresponding to the maximum number of virtual qubits that could be used in each tensor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">QuESTEnv</td><td>env QuEST environment object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00403">403</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00045">Tensor::firstGlobalPqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00046">Tensor::nextVqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00050">TensorNetwork::numTensors</a>, <a class="el" href="QuEST__tn_8h_source.html#l00044">Tensor::numVq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00042">Tensor::qureg</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00052">TensorNetwork::tensorIndexFromGlobalPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00054">TensorNetwork::tensorTailVqVertex</a>.</p>

<p class="reference">Referenced by <a class="el" href="testCircuit1_8c_source.html#l00006">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                     {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="structTensorNetwork.html">TensorNetwork</a> tn;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a> = numTensors;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// allocate memory in tensor object</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a> = malloc( numTensors*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>)) );</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a> = malloc( numTensors*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>)) );</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a> = malloc( numTensors*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>)) );</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a> = malloc( numTensors*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>)) );</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// calculate total number of qubits in system for qubits given per tensor</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">int</span> numTotalPq = 0;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">int</span> numTotalVq = 0;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numTensors; i++){</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        numTotalPq += numPqPerTensor[i];</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        numTotalVq += numVqPerTensor[i];</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">tensorIndexFromGlobalPq</a> = malloc( numTotalPq*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">tensorIndexFromGlobalPq</a>)) );</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// populate tensorIndexFromGlobalPq array. This contains duplicated values but should be</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// fast to look up</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">int</span> currentPq = 0;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numTensors; i++){</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordtype">int</span> numPqInCurrentTensor = numPqPerTensor[i];</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;numPqInCurrentTensor; j++){</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            tn.<a class="code" href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">tensorIndexFromGlobalPq</a>[currentPq++] = i;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">int</span> globalPqOffset = 0;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// populate tensor array</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> tmpTensor;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numTensors; i++){</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> = numPqPerTensor[i];</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a> = numVqPerTensor[i];</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">// create qureg object and initialize to zero</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a> = createQureg(tmpTensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> + tmpTensor.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a>, env);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        initZeroState(tmpTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">//if (i==0)statevec_initStateDebugFromOffset(tmpTensor.qureg, 0);</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">//if (i==1) hadamard(tmpTensor.qureg, 0);</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">//if (i==1) rotateZ(tmpTensor.qureg, 0, 0.3);</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="comment">//if (i==0) hadamard(tmpTensor.qureg, 0);</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> (i==0) pauliX(tmpTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, 0);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span> (i==0) rotateZ(tmpTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, 0, 0.3);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">//if (i==1)statevec_initStateDebugFromOffset(tmpTensor.qureg, 2);</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">// for quick conversion to local index from global index</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#aa3ed3b76e597c63a6146b666d241398d">firstGlobalPqIndex</a> = globalPqOffset;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">// the next virtual qubit to use</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> = 0;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[i] = tmpTensor;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[i] = NULL;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[i] = NULL;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[i] = 0;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        globalPqOffset += tmpTensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> tn;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div><div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad1bda148e46aac689b7a2cb9265d0390"><div class="ttname"><a href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">TensorNetwork::tensorIndexFromGlobalPq</a></div><div class="ttdeci">int * tensorIndexFromGlobalPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00052">QuEST_tn.h:52</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="structTensor_html_aae8329bae4c7f141f77d5449617e3ce0"><div class="ttname"><a href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">Tensor::nextVqIndex</a></div><div class="ttdeci">int nextVqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00046">QuEST_tn.h:46</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad46c386a71fed70e88cfa327871eaa90"><div class="ttname"><a href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">TensorNetwork::numTensors</a></div><div class="ttdeci">int numTensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00050">QuEST_tn.h:50</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structTensor_html_ab69644f02f0c6aad5483931e82d2fdd2"><div class="ttname"><a href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">Tensor::numVq</a></div><div class="ttdeci">int numVq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00044">QuEST_tn.h:44</a></div></div>
<div class="ttc" id="structTensorNetwork_html_af572173bbbd5831bafac1563fb42af61"><div class="ttname"><a href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">TensorNetwork::tensorTailVqVertex</a></div><div class="ttdeci">VqVertex ** tensorTailVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00054">QuEST_tn.h:54</a></div></div>
<div class="ttc" id="structTensor_html_a882c9fd399f54814efe79340fb90f23e"><div class="ttname"><a href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">Tensor::qureg</a></div><div class="ttdeci">Qureg qureg</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00042">QuEST_tn.h:42</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
<div class="ttc" id="structTensor_html_aa3ed3b76e597c63a6146b666d241398d"><div class="ttname"><a href="structTensor.html#aa3ed3b76e597c63a6146b666d241398d">Tensor::firstGlobalPqIndex</a></div><div class="ttdeci">int firstGlobalPqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00045">QuEST_tn.h:45</a></div></div>
<div class="ttc" id="structTensorNetwork_html"><div class="ttname"><a href="structTensorNetwork.html">TensorNetwork</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00049">QuEST_tn.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af01f5c813a7b9f00287fa5424284fcc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af01f5c813a7b9f00287fa5424284fcc9">&#9670;&nbsp;</a></span>getContractedIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long int getContractedIndex </td>
          <td>(</td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>activeStateVec1Index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>activeStateVec2Index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>stateVec1PhysicalSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>stateVec2PhysicalSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numTensor1Pq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numTensor2Pq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numTensor1UncontractedVqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numTensor2UncontractedVqs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the index in the output state vector where an element resulting from a contraction between two tensors should be placed. </p>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00128">128</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8c_source.html#l00013">DEBUG_PRINT</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                                                  {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            </div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> contractedIndex;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVec1IndexInPq, stateVec2IndexInPq;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOutputHalfBlock, sizeActiveHalfBlock;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">int</span> activeIsLower;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVectorIndex = 0;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> activeIndexInBlock;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// activeStateVec1Index % sateVec1PhysicalSize = activeStateVec1Index&amp;(stateVec1PhysicalSize-1)</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    stateVec1IndexInPq = activeStateVec1Index&amp;(stateVec1PhysicalSize-1);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    stateVec2IndexInPq = activeStateVec2Index&amp;(stateVec2PhysicalSize-1);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;getOutputIndex: t1psize %lld t2psize %lld\n&quot;</span>, stateVec1PhysicalSize, stateVec2PhysicalSize));</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    contractedIndex = stateVec2IndexInPq*stateVec1PhysicalSize + stateVec1IndexInPq;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;getOuputIndex: contractedIndex %lld\n&quot;</span>, contractedIndex));</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// TODO -- seems inefficient given the only thing changing between this and</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// activeStateVectorIndex is number of Pq (if tensor2 has no uncontracted vq?)</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    activeIndexInBlock = activeStateVec1Index;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=numTensor1UncontractedVqs-1; i&gt;=0; i--){</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// the size of a block of elements in the state vector for an uncontracted virtual qubit</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        sizeOutputHalfBlock = 1LL &lt;&lt; (numTensor1Pq + numTensor2Pq + i);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        sizeActiveHalfBlock = 1LL &lt;&lt; (numTensor1Pq + i);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        activeIsLower = (activeIndexInBlock &gt;= sizeActiveHalfBlock); <span class="comment">// TODO -- better to get value of qubit?</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;sizeOutput %lld sizeActive %lld isLower %d\n&quot;</span>, sizeOutputHalfBlock, sizeActiveHalfBlock, activeIsLower));</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (activeIsLower) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            contractedIndex += sizeOutputHalfBlock; <span class="comment">// TODO -- replace with predicate</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            activeIndexInBlock -= sizeActiveHalfBlock;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    activeIndexInBlock = activeStateVec2Index;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=numTensor2UncontractedVqs-1; i&gt;=0; i--){</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">// the size of a block of elements in the state vector for an uncontracted virtual qubit</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        sizeOutputHalfBlock = 1LL &lt;&lt; (numTensor1Pq + numTensor2Pq + numTensor1UncontractedVqs + i);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        sizeActiveHalfBlock = 1LL &lt;&lt; (numTensor2Pq + i);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        activeIsLower = (activeIndexInBlock &gt;= sizeActiveHalfBlock); <span class="comment">// TODO -- better to get value of qubit?</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;sizeOutput %lld sizeActive %lld isLower %d\n&quot;</span>, sizeOutputHalfBlock, sizeActiveHalfBlock, activeIsLower));</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> (activeIsLower) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            contractedIndex += sizeOutputHalfBlock; <span class="comment">// TODO -- replace with predicate</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            activeIndexInBlock -= sizeActiveHalfBlock;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">return</span> contractedIndex;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div><div class="ttc" id="QuEST__tn_8c_html_af6551f0b4c3964c3128f808e7bf987c7"><div class="ttname"><a href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a></div><div class="ttdeci">#define DEBUG_PRINT(x)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00013">QuEST_tn.c:13</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f0d16ecbd39a662bb17b21a6ba15d1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f0d16ecbd39a662bb17b21a6ba15d1b">&#9670;&nbsp;</a></span>getContractionVqIndices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getContractionVqIndices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensor1Index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensor2Index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numContractions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>tensor1Contractions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>tensor2Contractions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numTensor1UncontractedVqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numTensor2UncontractedVqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>tensor1UncontractedVqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>tensor2UncontractedVqs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For a particular contraction of two tensors, generate the lists of virtual qubits that will be contracted and that will remain uncontracted for each tensor. </p>
<p>The number of virtual qubits to contract must be the same for each tensor but the number of uncontracted qubits may differ</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn the tensor network that the two tensors belong to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>tensor1Index the first tensor to contract. This should have the lower index of the two tensors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>tensor2Index the second tensor to contract </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>numContractions the number of indices to contract over </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int**</td><td>tensor1Contractions tensor1 virtual qubits to contract </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int**</td><td>tensor2Contractions tensor2 virtual qubits to contract </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int*</td><td>numTensor1UncontractedVqs number of virtual qubits in tensor1 that represent entanglement with tensors other than tensor2 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int*</td><td>numTensor2UncontractedVqs number of virtual qubits in tensor2 that represent entanglement with tensors other than tensor1 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int**</td><td>tensor1UncontractedVqs virtual qubit indices that will remain uncontracted in tensor1 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">int**</td><td>tensor1UncontractedVqs virtual qubit indices that will remain uncontracted in tensor2 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00074">74</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00037">VqVertex::entangledPair</a>, <a class="el" href="QuEST__tn_8c_source.html#l00666">getVqVertexIndex()</a>, <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00038">VqVertex::tensorIndex</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                                                   {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// malloc space for array of virtual qubits to contract</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    *tensor1Contractions = malloc(numContractions*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    *tensor2Contractions = malloc(numContractions*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// malloc space for array of virtual qubits on each tensor that will not be contracted</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    *numTensor1UncontractedVqs = tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[tensor1Index] - numContractions;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    *numTensor2UncontractedVqs = tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[tensor2Index] - numContractions;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    *tensor1UncontractedVqs = malloc(*numTensor1UncontractedVqs *</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    *tensor2UncontractedVqs = malloc(*numTensor1UncontractedVqs *</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">int</span> contractionCount=0;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">int</span> uncontractedCount=0;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">int</span> vertexCount=0;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="structVqVertex.html">VqVertex</a> *tensorVertex, *entangledPair;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    tensorVertex = tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor1Index];</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">while</span> (tensorVertex != NULL){</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        entangledPair = tensorVertex-&gt;<a class="code" href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">entangledPair</a>;  </div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">if</span> (entangledPair-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a> == tensor2Index) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            (*tensor1Contractions)[contractionCount]=vertexCount++;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="comment">// add indices to contract in second tensor in same order as for first tensor</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordtype">int</span> entangledIndex = <a class="code" href="QuEST__tn_8c.html#af429a9a3a19a3c1b0f11a09326b5846f">getVqVertexIndex</a>(tn, entangledPair);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            (*tensor2Contractions)[contractionCount++]=entangledIndex;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            (*tensor1UncontractedVqs)[uncontractedCount++]=vertexCount++;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        tensorVertex = tensorVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    uncontractedCount=0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    vertexCount=0;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    tensorVertex = tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor2Index];</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">while</span> (tensorVertex != NULL){</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        entangledPair = tensorVertex-&gt;<a class="code" href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">entangledPair</a>;  </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">if</span> (!(entangledPair-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a> == tensor1Index)) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            (*tensor2UncontractedVqs)[uncontractedCount++]=vertexCount;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        vertexCount++;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        tensorVertex = tensorVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div><div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="structVqVertex_html_ab438ef9b43dc229425f893ae67ff34ba"><div class="ttname"><a href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">VqVertex::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00038">QuEST_tn.h:38</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
<div class="ttc" id="structVqVertex_html_a02e9d4de4db65179cb5eaa26df10a138"><div class="ttname"><a href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">VqVertex::entangledPair</a></div><div class="ttdeci">struct VqVertex * entangledPair</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00037">QuEST_tn.h:37</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_af429a9a3a19a3c1b0f11a09326b5846f"><div class="ttname"><a href="QuEST__tn_8c.html#af429a9a3a19a3c1b0f11a09326b5846f">getVqVertexIndex</a></div><div class="ttdeci">int getVqVertexIndex(TensorNetwork tn, VqVertex *vqVertex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00666">QuEST_tn.c:666</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6ac2be8a3e7da5fc5855a3b0b0656b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6ac2be8a3e7da5fc5855a3b0b0656b7">&#9670;&nbsp;</a></span>getLocalPq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structQCoord.html">QCoord</a> getLocalPq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>globalPq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00657">657</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00045">Tensor::firstGlobalPqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00032">QCoord::qIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00031">QCoord::tensorIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00052">TensorNetwork::tensorIndexFromGlobalPq</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00549">tn_controlledNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                                 {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="structQCoord.html">QCoord</a> localPq;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    localPq.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a> = tn.<a class="code" href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">tensorIndexFromGlobalPq</a>[globalPq];</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    localPq.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a> = globalPq - tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[localPq.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>].<a class="code" href="structTensor.html#aa3ed3b76e597c63a6146b666d241398d">firstGlobalPqIndex</a>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">return</span> localPq;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;}</div><div class="ttc" id="structQCoord_html"><div class="ttname"><a href="structQCoord.html">QCoord</a></div><div class="ttdoc">Naming conventions: </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00030">QuEST_tn.h:30</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad1bda148e46aac689b7a2cb9265d0390"><div class="ttname"><a href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">TensorNetwork::tensorIndexFromGlobalPq</a></div><div class="ttdeci">int * tensorIndexFromGlobalPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00052">QuEST_tn.h:52</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structQCoord_html_a7e5ae8370feb6e053cf69429fcc1e1e1"><div class="ttname"><a href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">QCoord::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00031">QuEST_tn.h:31</a></div></div>
<div class="ttc" id="structTensor_html_aa3ed3b76e597c63a6146b666d241398d"><div class="ttname"><a href="structTensor.html#aa3ed3b76e597c63a6146b666d241398d">Tensor::firstGlobalPqIndex</a></div><div class="ttdeci">int firstGlobalPqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00045">QuEST_tn.h:45</a></div></div>
<div class="ttc" id="structQCoord_html_a5c503116e9f5043a50a00a90bacdb032"><div class="ttname"><a href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">QCoord::qIndex</a></div><div class="ttdeci">int qIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00032">QuEST_tn.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a47c52a5805c348ef8517b3d91a760cdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47c52a5805c348ef8517b3d91a760cdd">&#9670;&nbsp;</a></span>getNumContractions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getNumContractions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensor1Index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensor2Index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the number of indices that will be contracted over when the two input tensors are contracted. </p>
<p>These correspond to all the virtual qubit indices that represent entanglement between the two tensors.</p>
<dl class="section return"><dt>Returns</dt><dd>the number of indices to contract </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn the tensor network that the two tensors belong to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>tensor1Index the first tensor to contract. This should have the lower index of the two tensors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>tensor2Index the second tensor to contract </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00041">41</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00037">VqVertex::entangledPair</a>, <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00038">VqVertex::tensorIndex</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                                                            {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">int</span> numContractions = 0;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="structVqVertex.html">VqVertex</a> *tensor1Vertex, *entangledPair;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    tensor1Vertex = tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor1Index];</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">while</span> (tensor1Vertex != NULL){</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        entangledPair = tensor1Vertex-&gt;<a class="code" href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">entangledPair</a>;  </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordflow">if</span> (entangledPair-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a> == tensor2Index) numContractions++;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        tensor1Vertex = tensor1Vertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">return</span> numContractions;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="structVqVertex_html_ab438ef9b43dc229425f893ae67ff34ba"><div class="ttname"><a href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">VqVertex::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00038">QuEST_tn.h:38</a></div></div>
<div class="ttc" id="structVqVertex_html_a02e9d4de4db65179cb5eaa26df10a138"><div class="ttname"><a href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">VqVertex::entangledPair</a></div><div class="ttdeci">struct VqVertex * entangledPair</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00037">QuEST_tn.h:37</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3392b1ff25fb2f1f60cc7af272659b11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3392b1ff25fb2f1f60cc7af272659b11">&#9670;&nbsp;</a></span>getStateVectorIndexFromActiveIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long int getStateVectorIndexFromActiveIndex </td>
          <td>(</td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>activeStateIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numPq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>uncontractedVqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numUncontractedVqs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00179">179</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                                                {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeHalfBlock, sizeActiveHalfBlock;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">int</span> activeIsLower;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> activeStatePhysicalSize = 1LL &lt;&lt; numPq;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexInPhysicalQubitBlock = activeStateIndex&amp;(activeStatePhysicalSize-1); </div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVectorIndex = indexInPhysicalQubitBlock;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> activeIndexInBlock = activeStateIndex;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=numUncontractedVqs-1; i&gt;=0; i--){</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordtype">int</span> vqIndex = uncontractedVqs[i];</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">// the size of a block of elements in the state vector for an uncontracted virtual qubit</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; (numPq + vqIndex);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        sizeActiveHalfBlock = 1LL &lt;&lt; (numPq + i);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        activeIsLower = (activeIndexInBlock &gt;= sizeActiveHalfBlock); <span class="comment">// TODO -- better to get value of qubit?</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (activeIsLower) {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            stateVectorIndex += sizeHalfBlock; <span class="comment">// TODO -- replace with predicate</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            activeIndexInBlock -= sizeActiveHalfBlock;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span> stateVectorIndex;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="af429a9a3a19a3c1b0f11a09326b5846f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af429a9a3a19a3c1b0f11a09326b5846f">&#9670;&nbsp;</a></span>getVqVertexIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getVqVertexIndex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVqVertex.html">VqVertex</a> *&#160;</td>
          <td class="paramname"><em>vqVertex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00666">666</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00038">VqVertex::tensorIndex</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00074">getContractionVqIndices()</a>, and <a class="el" href="QuEST__tn_8c_source.html#l00677">printTensorNetwork()</a>.</p>
<div class="fragment"><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                                          {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordtype">int</span> verticesUntilEndInclusive=0;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordtype">int</span> totalVertices = tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[vqVertex-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a>];</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span> (vqVertex == NULL) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">while</span> (vqVertex != NULL){</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        verticesUntilEndInclusive++;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        vqVertex = vqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">return</span> totalVertices - verticesUntilEndInclusive;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div><div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html_ab438ef9b43dc229425f893ae67ff34ba"><div class="ttname"><a href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">VqVertex::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00038">QuEST_tn.h:38</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a502a2f31cd89e3e8ad3148f2de2ac346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a502a2f31cd89e3e8ad3148f2de2ac346">&#9670;&nbsp;</a></span>initVirtualControl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initVirtualControl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensor.html">Tensor</a>&#160;</td>
          <td class="paramname"><em>tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vqIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00620">620</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00042">Tensor::qureg</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00549">tn_controlledNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                                   {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// initialize qubit vqIndex to |0&gt; + |1&gt; </span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// NOTE: not (1/sqrt(2))(|0&gt; + |1&gt;)</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">// TODO: add API funtions to do this instead?</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    Qureg qureg = tensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// TODO: This won&#39;t work in parallel</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    stateVecSize = 1LL &lt;&lt; vqIndex;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    qreal *stateVecReal = qureg.stateVec.real;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    qreal *stateVecImag = qureg.stateVec.imag;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor">    default  (none) \</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">    private  (index)</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor"># pragma omp for schedule (static)</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            stateVecReal[index+stateVecSize] = stateVecReal[index];</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            stateVecImag[index+stateVecSize] = stateVecImag[index];</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div><div class="ttc" id="structTensor_html_a882c9fd399f54814efe79340fb90f23e"><div class="ttname"><a href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">Tensor::qureg</a></div><div class="ttdeci">Qureg qureg</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00042">QuEST_tn.h:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac981843cd91f909690681de3eb5e8a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac981843cd91f909690681de3eb5e8a64">&#9670;&nbsp;</a></span>initVirtualTarget()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initVirtualTarget </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensor.html">Tensor</a>&#160;</td>
          <td class="paramname"><em>tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vqIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00614">614</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00042">Tensor::qureg</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00549">tn_controlledNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                                  {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">// place target virtual qubit in the zero state</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    </div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;     collapseToOutcome(tensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, vqIndex, 0);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div><div class="ttc" id="structTensor_html_a882c9fd399f54814efe79340fb90f23e"><div class="ttname"><a href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">Tensor::qureg</a></div><div class="ttdeci">Qureg qureg</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00042">QuEST_tn.h:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25f06328d45b2f509185b89773c9163e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25f06328d45b2f509185b89773c9163e">&#9670;&nbsp;</a></span>printTensorNetwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printTensorNetwork </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print all tensors in a tensor network and their entanglement with other tensors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn the tensor network to print </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00677">677</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00037">VqVertex::entangledPair</a>, <a class="el" href="QuEST__tn_8c_source.html#l00666">getVqVertexIndex()</a>, <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00050">TensorNetwork::numTensors</a>, <a class="el" href="QuEST__tn_8h_source.html#l00044">Tensor::numVq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00038">VqVertex::tensorIndex</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>.</p>

<p class="reference">Referenced by <a class="el" href="testCircuit1_8c_source.html#l00006">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                         {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    printf(<span class="stringliteral">&quot;\n----- TensorNetwork -------------------- \n&quot;</span>);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    printf(<span class="stringliteral">&quot;%d tensors\n&quot;</span>, tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a>);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a>; i++){</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="structTensor.html">Tensor</a> tensor = tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[i];</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">if</span> (tensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>==0){</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            printf(<span class="stringliteral">&quot;Tensor %d: DELETED BY CONTRACTION\n&quot;</span>, i);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            printf(<span class="stringliteral">&quot;Tensor %d: %d physical qubits, %d virtual qubits\n&quot;</span>, i, tensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>, tensor.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a>);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            printf(<span class="stringliteral">&quot;\t%d Entanglements:\n&quot;</span>, tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[i]);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            </div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="structVqVertex.html">VqVertex</a> *vqVertex = tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[i];</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <a class="code" href="structVqVertex.html">VqVertex</a> *entangledPair;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordtype">int</span> vqCount=0;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">while</span> (vqVertex != NULL){</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                entangledPair = vqVertex-&gt;<a class="code" href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">entangledPair</a>;  </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                <span class="keywordtype">int</span> entangledIndex = <a class="code" href="QuEST__tn_8c.html#af429a9a3a19a3c1b0f11a09326b5846f">getVqVertexIndex</a>(tn, entangledPair);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                printf(<span class="stringliteral">&quot;\t\tVirtual qubit %d -&gt; tensor %d, virtual qubit %d\n&quot;</span>, </div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        vqCount++, entangledPair-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a>, entangledIndex);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                vqVertex = vqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">//    printf(&quot;\n--------------------------------------- \n&quot;);</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div><div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="structVqVertex_html_ab438ef9b43dc229425f893ae67ff34ba"><div class="ttname"><a href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">VqVertex::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00038">QuEST_tn.h:38</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="structVqVertex_html_a02e9d4de4db65179cb5eaa26df10a138"><div class="ttname"><a href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">VqVertex::entangledPair</a></div><div class="ttdeci">struct VqVertex * entangledPair</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00037">QuEST_tn.h:37</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad46c386a71fed70e88cfa327871eaa90"><div class="ttname"><a href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">TensorNetwork::numTensors</a></div><div class="ttdeci">int numTensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00050">QuEST_tn.h:50</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structTensor_html_ab69644f02f0c6aad5483931e82d2fdd2"><div class="ttname"><a href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">Tensor::numVq</a></div><div class="ttdeci">int numVq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00044">QuEST_tn.h:44</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_af429a9a3a19a3c1b0f11a09326b5846f"><div class="ttname"><a href="QuEST__tn_8c.html#af429a9a3a19a3c1b0f11a09326b5846f">getVqVertexIndex</a></div><div class="ttdeci">int getVqVertexIndex(TensorNetwork tn, VqVertex *vqVertex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00666">QuEST_tn.c:666</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a629ac80385cf6ba6b9067a99d23b9946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a629ac80385cf6ba6b9067a99d23b9946">&#9670;&nbsp;</a></span>recursiveContract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Complex recursiveContract </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensor.html">Tensor</a>&#160;</td>
          <td class="paramname"><em>tensor1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTensor.html">Tensor</a>&#160;</td>
          <td class="paramname"><em>tensor2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>tensor1Offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>tensor2Offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tensor1Contractions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tensor2Contractions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numContractions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vqIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00202">202</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8c_source.html#l00013">DEBUG_PRINT</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00042">Tensor::qureg</a>, and <a class="el" href="QuEST__tn_8c_source.html#l00202">recursiveContract()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>, and <a class="el" href="QuEST__tn_8c_source.html#l00202">recursiveContract()</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                         {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;recursive step. vqIndex: %d t1vqToContract %d\n&quot;</span>, vqIndex, tensor1Contractions[vqIndex]));</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">//TODO -- numPq will need to be numPq + numUnusedLowVq</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> tensor1OffsetNew = tensor1Offset + (1LL &lt;&lt; (tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>+tensor1Contractions[vqIndex]) );</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> tensor2OffsetNew = tensor2Offset + (1LL &lt;&lt; (tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>+tensor2Contractions[vqIndex]) );</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;tensor1Offset %lld tensor2Offset %lld\n&quot;</span>, tensor1Offset, tensor2Offset));</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;tensor1OffsetNew %lld tensor2OffsetNew %lld\n&quot;</span>, tensor1OffsetNew, tensor2OffsetNew));</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;num pq %d contraction index %d\n&quot;</span>, tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>, tensor1Contractions[vqIndex]));</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   </div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (vqIndex==numContractions-1){</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        Qureg qureg1 = tensor1.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        Qureg qureg2 = tensor2.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        qreal *stateVec1Real = qureg1.stateVec.real;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        qreal *stateVec1Imag = qureg1.stateVec.imag;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        qreal *stateVec2Real = qureg2.stateVec.real;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        qreal *stateVec2Imag = qureg2.stateVec.imag;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        qreal sumReal=0;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        qreal sumImag=0;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">// vqIndex == 0 </span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">// Real component</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        sumReal += stateVec1Real[tensor1Offset] * </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            stateVec2Real[tensor2Offset];</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        sumReal += -stateVec1Imag[tensor1Offset] * </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            stateVec2Imag[tensor2Offset];</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">// Imag component</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        sumImag += stateVec1Imag[tensor1Offset] * </div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            stateVec2Real[tensor2Offset];</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        sumImag += stateVec1Real[tensor1Offset] * </div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            stateVec2Imag[tensor2Offset];</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="comment">// vqIndex == 1 </span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="comment">// Real component</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        sumReal += stateVec1Real[tensor1OffsetNew] * </div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            stateVec2Real[tensor2OffsetNew];</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        sumReal += -stateVec1Imag[tensor1OffsetNew] * </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            stateVec2Imag[tensor2OffsetNew];</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">// Imag component</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        sumImag += stateVec1Imag[tensor1OffsetNew] * </div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            stateVec2Real[tensor2OffsetNew];</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        sumImag += stateVec1Real[tensor1OffsetNew] * </div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            stateVec2Imag[tensor2OffsetNew];</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;       </div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        Complex sum;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        sum.real = sumReal; sum.imag = sumImag;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">return</span> sum;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        Complex sumPart1, sumPart2, sum;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            sumPart1 = <a class="code" href="QuEST__tn_8c.html#a629ac80385cf6ba6b9067a99d23b9946">recursiveContract</a>(tensor1, tensor2, tensor1Offset, tensor2Offset, </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                tensor1Contractions, tensor2Contractions, numContractions, vqIndex+1);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            sumPart2 = <a class="code" href="QuEST__tn_8c.html#a629ac80385cf6ba6b9067a99d23b9946">recursiveContract</a>(tensor1, tensor2, tensor1OffsetNew, tensor2OffsetNew, </div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                tensor1Contractions, tensor2Contractions, numContractions, vqIndex+1);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        sum.real = sumPart1.real + sumPart2.real;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        sum.imag = sumPart1.imag + sumPart2.imag;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> sum;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div><div class="ttc" id="QuEST__tn_8c_html_af6551f0b4c3964c3128f808e7bf987c7"><div class="ttname"><a href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a></div><div class="ttdeci">#define DEBUG_PRINT(x)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00013">QuEST_tn.c:13</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="structTensor_html_a882c9fd399f54814efe79340fb90f23e"><div class="ttname"><a href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">Tensor::qureg</a></div><div class="ttdeci">Qureg qureg</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00042">QuEST_tn.h:42</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a629ac80385cf6ba6b9067a99d23b9946"><div class="ttname"><a href="QuEST__tn_8c.html#a629ac80385cf6ba6b9067a99d23b9946">recursiveContract</a></div><div class="ttdeci">Complex recursiveContract(Tensor tensor1, Tensor tensor2, long long int tensor1Offset, long long int tensor2Offset, int *tensor1Contractions, int *tensor2Contractions, int numContractions, int vqIndex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00202">QuEST_tn.c:202</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a64f43b029eab36c891ccba576b009914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64f43b029eab36c891ccba576b009914">&#9670;&nbsp;</a></span>remapFirstGlobalPqIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void remapFirstGlobalPqIndex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00482">482</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00045">Tensor::firstGlobalPqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00050">TensorNetwork::numTensors</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                              {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordtype">int</span> globalPqOffset = 0;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a>; i++){</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <a class="code" href="structTensor.html">Tensor</a> tensor = tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[i];</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        tensor.<a class="code" href="structTensor.html#aa3ed3b76e597c63a6146b666d241398d">firstGlobalPqIndex</a> = globalPqOffset;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        globalPqOffset += tensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div><div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad46c386a71fed70e88cfa327871eaa90"><div class="ttname"><a href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">TensorNetwork::numTensors</a></div><div class="ttdeci">int numTensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00050">QuEST_tn.h:50</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structTensor_html_aa3ed3b76e597c63a6146b666d241398d"><div class="ttname"><a href="structTensor.html#aa3ed3b76e597c63a6146b666d241398d">Tensor::firstGlobalPqIndex</a></div><div class="ttdeci">int firstGlobalPqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00045">QuEST_tn.h:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d832a151f2596273ed4fcda5634ee53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d832a151f2596273ed4fcda5634ee53">&#9670;&nbsp;</a></span>remapTensorIndexFromGlobalPq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void remapTensorIndexFromGlobalPq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00471">471</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00050">TensorNetwork::numTensors</a>, <a class="el" href="QuEST__tn_8h_source.html#l00052">TensorNetwork::tensorIndexFromGlobalPq</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                                   {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">int</span> currentPq = 0;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a>; i++){</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="structTensor.html">Tensor</a> tensor = tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[i];</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;tensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>; j++){</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            tn.<a class="code" href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">tensorIndexFromGlobalPq</a>[currentPq++] = i;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div><div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad1bda148e46aac689b7a2cb9265d0390"><div class="ttname"><a href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">TensorNetwork::tensorIndexFromGlobalPq</a></div><div class="ttdeci">int * tensorIndexFromGlobalPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00052">QuEST_tn.h:52</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad46c386a71fed70e88cfa327871eaa90"><div class="ttname"><a href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">TensorNetwork::numTensors</a></div><div class="ttdeci">int numTensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00050">QuEST_tn.h:50</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a84bbb3abdea1ae82b3c2ce2950bc445d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84bbb3abdea1ae82b3c2ce2950bc445d">&#9670;&nbsp;</a></span>removeAllVqVertices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void removeAllVqVertices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensorIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00491">491</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                                           {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="structVqVertex.html">VqVertex</a> *prevVqVertex;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="structVqVertex.html">VqVertex</a> *vqVertex = tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensorIndex];</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">while</span> (vqVertex != NULL){</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        prevVqVertex = vqVertex;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        vqVertex = vqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        free(prevVqVertex);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div><div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d0a76659767015c051ffc959e723693"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d0a76659767015c051ffc959e723693">&#9670;&nbsp;</a></span>removeContractedVqVertices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void removeContractedVqVertices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensorIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newTensorIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVqVertex.html">VqVertex</a> *&#160;</td>
          <td class="paramname"><em>startingVqVertex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVqVertex.html">VqVertex</a> *&#160;</td>
          <td class="paramname"><em>prevVqVertexToKeep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>uncontractedVqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numUncontractedVqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVqVertex.html">VqVertex</a> **&#160;</td>
          <td class="paramname"><em>tail</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>foundHead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00501">501</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00038">VqVertex::tensorIndex</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                                                                      {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="structVqVertex.html">VqVertex</a> *vqVertex, *prevVqVertex;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">int</span> vqVertexCount = 0;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">int</span> uncontractedVqCount = 0;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    vqVertex = startingVqVertex;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// Search through vertices and keep those which are in uncontractedVqs.</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// Free vertices which no longer need to be stored</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">while</span> (vqVertex != NULL){</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (uncontractedVqCount&lt;numUncontractedVqs) {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="keywordflow">if</span> (vqVertexCount++ == uncontractedVqs[uncontractedVqCount]) {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                <span class="comment">// keep </span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                <span class="keywordflow">if</span> (vqVertex-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a> != newTensorIndex) vqVertex-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a> = newTensorIndex;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="keywordflow">if</span> (!(*foundHead)) {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensorIndex] = vqVertex;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    *foundHead = 1;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="keywordflow">if</span> (prevVqVertexToKeep!=NULL){</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                    prevVqVertexToKeep-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = vqVertex;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                prevVqVertexToKeep = vqVertex;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                vqVertex = vqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                uncontractedVqCount++;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="comment">// discard</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                prevVqVertex = vqVertex;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                vqVertex = vqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                free(prevVqVertex);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="comment">// discard</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            prevVqVertex = vqVertex;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            vqVertex = vqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            free(prevVqVertex);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    *tail = prevVqVertexToKeep;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">if</span> (prevVqVertexToKeep != NULL){</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        prevVqVertexToKeep-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>=NULL;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;} </div><div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="structVqVertex_html_ab438ef9b43dc229425f893ae67ff34ba"><div class="ttname"><a href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">VqVertex::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00038">QuEST_tn.h:38</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac72c327e053be69896f5660f5655e59c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac72c327e053be69896f5660f5655e59c">&#9670;&nbsp;</a></span>tn_controlledNot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tn_controlledNot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate on qubits in a tensor network. </p>
<p>If the two qubits are in different tensors, also track the entanglement introduced between those tensors using virtual qubits.</p>
<p>Note that the control and target qubits should be supplied as global qubit indices over all physical qubits in all tensors.</p>
<p>This applies pauliX to the target qubit if the control qubit has value 1. This effects the two-qubit unitary </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; &amp; 1 \\ &amp; &amp; 1 \end{pmatrix} \]" src="form_0.png"/>
</p>
<p> on the control and target qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, -.5); \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \end{tikzpicture} } \]" src="form_1.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn the tensor network containing the control and target qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>nots the target if this qubit is 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to not </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>qureg.numQubitsRepresented</code>), or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00549">549</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8c_source.html#l00013">DEBUG_PRINT</a>, <a class="el" href="QuEST__tn_8h_source.html#l00037">VqVertex::entangledPair</a>, <a class="el" href="QuEST__tn_8c_source.html#l00657">getLocalPq()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00620">initVirtualControl()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00614">initVirtualTarget()</a>, <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00046">Tensor::nextVqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00032">QCoord::qIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00042">Tensor::qureg</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00031">QCoord::tensorIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00038">VqVertex::tensorIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00054">TensorNetwork::tensorTailVqVertex</a>.</p>

<p class="reference">Referenced by <a class="el" href="testCircuit1_8c_source.html#l00006">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                                                                      {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="structQCoord.html">QCoord</a> controlPqLocal = <a class="code" href="QuEST__tn_8c.html#ac6ac2be8a3e7da5fc5855a3b0b0656b7">getLocalPq</a>(tn, controlQubit);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="structQCoord.html">QCoord</a> targetPqLocal = <a class="code" href="QuEST__tn_8c.html#ac6ac2be8a3e7da5fc5855a3b0b0656b7">getLocalPq</a>(tn, targetQubit);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> *controlTensor = &amp;(tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a> == targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>){</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="comment">// qubits are in same tensor/qureg. Just do a normal qureg operation</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        controlledNot(controlTensor-&gt;<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, controlPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>, targetPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="comment">// qubits are in different tensor/qureg</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">// do control tensor half</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">// TODO: note this won&#39;t work if doing multiple different operations on the same tensor in parallel </span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordtype">int</span> virtualTargetIndex = controlTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">// TODO -- shouldn&#39;t have to initialize virtual target when virtual qubits are</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="comment">// automatically initialized in the zero state</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="QuEST__tn_8c.html#ac981843cd91f909690681de3eb5e8a64">initVirtualTarget</a>(*controlTensor, virtualTargetIndex + controlTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        controlTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> = controlTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> + 1;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;controlled not 1: %d %d\n&quot;</span>, controlPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>, virtualTargetIndex + controlTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>));</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        controlledNot(controlTensor-&gt;<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, controlPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>, virtualTargetIndex + controlTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">// do target tensor half</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">// TODO: note this won&#39;t work if doing multiple different operations on the same tensor in parallel </span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="structTensor.html">Tensor</a> *targetTensor = &amp;(tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordtype">int</span> virtualControlIndex = targetTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <a class="code" href="QuEST__tn_8c.html#a502a2f31cd89e3e8ad3148f2de2ac346">initVirtualControl</a>(*targetTensor, virtualControlIndex + targetTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        targetTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> = targetTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> + 1;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;controlled not 2: %d %d\n&quot;</span>, virtualControlIndex + targetTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>, targetPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        controlledNot(targetTensor-&gt;<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, virtualControlIndex + targetTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>, targetPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;     </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">// TODO -- change t1, t2 to control/target </span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment">// update adjacency list. </span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="comment">// tensor1</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="structVqVertex.html">VqVertex</a> *tensor1VqVertex = malloc(<span class="keyword">sizeof</span>(*tensor1VqVertex));</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        tensor1VqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = NULL;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        tensor1VqVertex-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a> = targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">if</span> (tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] != NULL){</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = tensor1VqVertex;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] = tensor1VqVertex;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">if</span> (tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]==0) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] = tensor1VqVertex;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">// tensor2</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="structVqVertex.html">VqVertex</a> *tensor2VqVertex = malloc(<span class="keyword">sizeof</span>(*tensor2VqVertex));</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        tensor2VqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = NULL;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        tensor2VqVertex-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a> = controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">if</span> (tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] != NULL){</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = tensor2VqVertex;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] = tensor2VqVertex;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">if</span> (tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]==0) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] = tensor2VqVertex;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        tensor1VqVertex-&gt;<a class="code" href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">entangledPair</a> = tensor2VqVertex;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        tensor2VqVertex-&gt;<a class="code" href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">entangledPair</a> = tensor1VqVertex;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]++;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]++;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div><div class="ttc" id="structQCoord_html"><div class="ttname"><a href="structQCoord.html">QCoord</a></div><div class="ttdoc">Naming conventions: </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00030">QuEST_tn.h:30</a></div></div>
<div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_af6551f0b4c3964c3128f808e7bf987c7"><div class="ttname"><a href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a></div><div class="ttdeci">#define DEBUG_PRINT(x)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00013">QuEST_tn.c:13</a></div></div>
<div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="structVqVertex_html_ab438ef9b43dc229425f893ae67ff34ba"><div class="ttname"><a href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">VqVertex::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00038">QuEST_tn.h:38</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a502a2f31cd89e3e8ad3148f2de2ac346"><div class="ttname"><a href="QuEST__tn_8c.html#a502a2f31cd89e3e8ad3148f2de2ac346">initVirtualControl</a></div><div class="ttdeci">void initVirtualControl(Tensor tensor, int vqIndex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00620">QuEST_tn.c:620</a></div></div>
<div class="ttc" id="structVqVertex_html_a02e9d4de4db65179cb5eaa26df10a138"><div class="ttname"><a href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">VqVertex::entangledPair</a></div><div class="ttdeci">struct VqVertex * entangledPair</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00037">QuEST_tn.h:37</a></div></div>
<div class="ttc" id="structTensor_html_aae8329bae4c7f141f77d5449617e3ce0"><div class="ttname"><a href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">Tensor::nextVqIndex</a></div><div class="ttdeci">int nextVqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00046">QuEST_tn.h:46</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_ac6ac2be8a3e7da5fc5855a3b0b0656b7"><div class="ttname"><a href="QuEST__tn_8c.html#ac6ac2be8a3e7da5fc5855a3b0b0656b7">getLocalPq</a></div><div class="ttdeci">QCoord getLocalPq(TensorNetwork tn, int globalPq)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00657">QuEST_tn.c:657</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structQCoord_html_a7e5ae8370feb6e053cf69429fcc1e1e1"><div class="ttname"><a href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">QCoord::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00031">QuEST_tn.h:31</a></div></div>
<div class="ttc" id="structTensorNetwork_html_af572173bbbd5831bafac1563fb42af61"><div class="ttname"><a href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">TensorNetwork::tensorTailVqVertex</a></div><div class="ttdeci">VqVertex ** tensorTailVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00054">QuEST_tn.h:54</a></div></div>
<div class="ttc" id="structTensor_html_a882c9fd399f54814efe79340fb90f23e"><div class="ttname"><a href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">Tensor::qureg</a></div><div class="ttdeci">Qureg qureg</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00042">QuEST_tn.h:42</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_ac981843cd91f909690681de3eb5e8a64"><div class="ttname"><a href="QuEST__tn_8c.html#ac981843cd91f909690681de3eb5e8a64">initVirtualTarget</a></div><div class="ttdeci">void initVirtualTarget(Tensor tensor, int vqIndex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00614">QuEST_tn.c:614</a></div></div>
<div class="ttc" id="structQCoord_html_a5c503116e9f5043a50a00a90bacdb032"><div class="ttname"><a href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">QCoord::qIndex</a></div><div class="ttdeci">int qIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00032">QuEST_tn.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 17 2019 15:05:20 for Quantum Exact Simulation Toolkit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>

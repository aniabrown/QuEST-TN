<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Exact Simulation Toolkit: QuEST_tn.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quantum Exact Simulation Toolkit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_43e0a1f539e00dcfa1a6bc4d4fee4fc2.html">home</a></li><li class="navelem"><a class="el" href="dir_8ae12c0f030e269d6ff542b3c3105a2c.html">ania</a></li><li class="navelem"><a class="el" href="dir_76d8ae1525f7f128f3576c1c2bb27bae.html">Documents</a></li><li class="navelem"><a class="el" href="dir_c9583ccc1263fb3720e00a8c946d9d46.html">no_sync</a></li><li class="navelem"><a class="el" href="dir_339c8b083f7b8e3a80a541920a47a31f.html">git_QuEST-TN</a></li><li class="navelem"><a class="el" href="dir_b16590c90928eee0254f9005564191c1.html">TN</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">QuEST_tn.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;QuEST.h&quot;</code><br />
</div>
<p><a href="QuEST__tn_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structQCoord.html">QCoord</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Naming conventions:  <a href="structQCoord.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTensor.html">Tensor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structVqVertex.html">VqVertex</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a1430697e651b7d6aa1696ab0b6f2526d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structQCoord.html">QCoord</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#a1430697e651b7d6aa1696ab0b6f2526d">QCoord</a></td></tr>
<tr class="memdesc:a1430697e651b7d6aa1696ab0b6f2526d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Naming conventions:  <a href="#a1430697e651b7d6aa1696ab0b6f2526d">More...</a><br /></td></tr>
<tr class="separator:a1430697e651b7d6aa1696ab0b6f2526d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3e6d6e3c82e36fe71a50d1be3f97192"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structTensor.html">Tensor</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#ad3e6d6e3c82e36fe71a50d1be3f97192">Tensor</a></td></tr>
<tr class="separator:ad3e6d6e3c82e36fe71a50d1be3f97192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3475099efee71fb0c40fd5fc1779bf49"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#a3475099efee71fb0c40fd5fc1779bf49">TensorNetwork</a></td></tr>
<tr class="separator:a3475099efee71fb0c40fd5fc1779bf49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3612662418dce2202f3d33fb53ec4292"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structVqVertex.html">VqVertex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#a3612662418dce2202f3d33fb53ec4292">VqVertex</a></td></tr>
<tr class="separator:a3612662418dce2202f3d33fb53ec4292"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9bddda7801050a3a3feceabe977ce2ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#a9bddda7801050a3a3feceabe977ce2ea">contractTensorNetwork</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, QuESTEnv env)</td></tr>
<tr class="memdesc:a9bddda7801050a3a3feceabe977ce2ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contract all tensors in a tensor network one by one.  <a href="#a9bddda7801050a3a3feceabe977ce2ea">More...</a><br /></td></tr>
<tr class="separator:a9bddda7801050a3a3feceabe977ce2ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d99a07e211802bb96b0fe0e79c696d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#a7d99a07e211802bb96b0fe0e79c696d7">contractTensors</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, int tensor1, int tensor2, QuESTEnv env)</td></tr>
<tr class="memdesc:a7d99a07e211802bb96b0fe0e79c696d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces the tensor object at index tensor1 in the tensor network with the contraction of tensor1 and tensor 2.  <a href="#a7d99a07e211802bb96b0fe0e79c696d7">More...</a><br /></td></tr>
<tr class="separator:a7d99a07e211802bb96b0fe0e79c696d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb46e2a13b03f3dc171437eec5e54a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#a8eb46e2a13b03f3dc171437eec5e54a5">createTensorNetwork</a> (int numTensors, int *numPqPerTensor, int *numVqPerTensor, QuESTEnv env)</td></tr>
<tr class="memdesc:a8eb46e2a13b03f3dc171437eec5e54a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for and initialize a new tensor network object given the number of physical qubits and maximum number of virtual qubits in each tensor.  <a href="#a8eb46e2a13b03f3dc171437eec5e54a5">More...</a><br /></td></tr>
<tr class="separator:a8eb46e2a13b03f3dc171437eec5e54a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25f06328d45b2f509185b89773c9163e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#a25f06328d45b2f509185b89773c9163e">printTensorNetwork</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn)</td></tr>
<tr class="memdesc:a25f06328d45b2f509185b89773c9163e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print all tensors in a tensor network and their entanglement with other tensors.  <a href="#a25f06328d45b2f509185b89773c9163e">More...</a><br /></td></tr>
<tr class="separator:a25f06328d45b2f509185b89773c9163e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac72c327e053be69896f5660f5655e59c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#ac72c327e053be69896f5660f5655e59c">tn_controlledNot</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, const int controlQubit, const int targetQubit)</td></tr>
<tr class="memdesc:ac72c327e053be69896f5660f5655e59c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate on qubits in a tensor network.  <a href="#ac72c327e053be69896f5660f5655e59c">More...</a><br /></td></tr>
<tr class="separator:ac72c327e053be69896f5660f5655e59c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11972021bb4e110960b143c8d13e9a92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__tn_8h.html#a11972021bb4e110960b143c8d13e9a92">tn_unitary</a> (<a class="el" href="structTensorNetwork.html">TensorNetwork</a> tn, const int targetQubit, ComplexMatrix2 u)</td></tr>
<tr class="memdesc:a11972021bb4e110960b143c8d13e9a92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a general single-qubit unitary (including a global phase factor).  <a href="#a11972021bb4e110960b143c8d13e9a92">More...</a><br /></td></tr>
<tr class="separator:a11972021bb4e110960b143c8d13e9a92"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a1430697e651b7d6aa1696ab0b6f2526d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1430697e651b7d6aa1696ab0b6f2526d">&#9670;&nbsp;</a></span>QCoord</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structQCoord.html">QCoord</a>  <a class="el" href="structQCoord.html">QCoord</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Naming conventions: </p>
<p>vq = virtual qubit pq = physical qubit These are not capitalised by default to distinguish ordinary vars from structs such as <a class="el" href="structVqVertex.html">VqVertex</a>, which do have the first letter capitalised.</p>
<p>Unless marked as global in the name, all var names that refer to qubit indices refer to local index within a tensor and qubit type. i.e. physical qubits in tensor 2 start from index 0, and virtual qubits in tensor 2 also start from index 0.</p>
<p>In a contraction, the two tensors are referred to as tensor1 and tensor2, where tensor1 is the tensor with the lower index in <a class="el" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork.tensors</a></p>
<p>In a contraction, all shared (virtual qubit) indices between tensor1 and tensor2 will be contracted. The lists of virtual qubit indices corresponding to these contractions are referred to as tensor1Contractions and tensor2Contractions. The lists of any other virtual qubits which are not being contracted as they represent entanglements with other tensors, are referred to as tensor1UncontractedVqs and tensor2UncontractedVqs. </p>

</div>
</div>
<a id="ad3e6d6e3c82e36fe71a50d1be3f97192"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3e6d6e3c82e36fe71a50d1be3f97192">&#9670;&nbsp;</a></span>Tensor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTensor.html">Tensor</a>  <a class="el" href="structTensor.html">Tensor</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3475099efee71fb0c40fd5fc1779bf49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3475099efee71fb0c40fd5fc1779bf49">&#9670;&nbsp;</a></span>TensorNetwork</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTensorNetwork.html">TensorNetwork</a>  <a class="el" href="structTensorNetwork.html">TensorNetwork</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3612662418dce2202f3d33fb53ec4292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3612662418dce2202f3d33fb53ec4292">&#9670;&nbsp;</a></span>VqVertex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structVqVertex.html">VqVertex</a>  <a class="el" href="structVqVertex.html">VqVertex</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9bddda7801050a3a3feceabe977ce2ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bddda7801050a3a3feceabe977ce2ea">&#9670;&nbsp;</a></span>contractTensorNetwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void contractTensorNetwork </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuESTEnv&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Contract all tensors in a tensor network one by one. </p>
<p>The simplest strategy &ndash; contract tensor 0 with every other tensor in turn Output will be stored as tensor 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn tensor network to contract </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">QuESTEnv</td><td>env QuEST environment object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00024">24</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8c_source.html#l00269">contractTensors()</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00050">TensorNetwork::numTensors</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                                                          {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a>; i++){</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="QuEST__tn_8c.html#adb7fb87ab056b361cd2007bbea77f2d5">contractTensors</a>(tn, 0, i, env);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;}</div><div class="ttc" id="QuEST__tn_8c_html_adb7fb87ab056b361cd2007bbea77f2d5"><div class="ttname"><a href="QuEST__tn_8c.html#adb7fb87ab056b361cd2007bbea77f2d5">contractTensors</a></div><div class="ttdeci">void contractTensors(TensorNetwork tn, int tensor1Index, int tensor2Index, QuESTEnv env)</div><div class="ttdoc">Replaces the tensor object at index tensor1 in the tensor network with the contraction of tensor1 and...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00269">QuEST_tn.c:269</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad46c386a71fed70e88cfa327871eaa90"><div class="ttname"><a href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">TensorNetwork::numTensors</a></div><div class="ttdeci">int numTensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00050">QuEST_tn.h:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d99a07e211802bb96b0fe0e79c696d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d99a07e211802bb96b0fe0e79c696d7">&#9670;&nbsp;</a></span>contractTensors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void contractTensors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensor1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tensor2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuESTEnv&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Replaces the tensor object at index tensor1 in the tensor network with the contraction of tensor1 and tensor 2. </p>
<p>All virtual qubits linking the two tensors are contracted in this operation. There may be virtual qubits left over after the contraction, corresponding to entanglement with other tensors in the network.</p>
<p>The ordering of qubits in the output tensor from lowest to highest is as follows: tensor1 physical qubits, tensor2 physical qubits, tensor1 virtual qubits, tensor2 virtual qubits.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn the tensor network the two tensors belong to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>tensor1 the index of the first tensor to contract </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>tensor1 the index of the second tensor to contract </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">QuESTEnv</td><td>env the QuEST environment object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00269">269</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8c_source.html#l00013">DEBUG_PRINT</a>, <a class="el" href="QuEST__tn_8c_source.html#l00128">getContractedIndex()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00074">getContractionVqIndices()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00041">getNumContractions()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00179">getStateVectorIndexFromActiveIndex()</a>, <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00046">Tensor::nextVqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00044">Tensor::numVq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00042">Tensor::qureg</a>, <a class="el" href="QuEST__tn_8c_source.html#l00202">recursiveContract()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00482">remapFirstGlobalPqIndex()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00471">remapTensorIndexFromGlobalPq()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00501">removeContractedVqVertices()</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00054">TensorNetwork::tensorTailVqVertex</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__tn_8c_source.html#l00024">contractTensorNetwork()</a>, and <a class="el" href="testCircuit1_8c_source.html#l00006">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                                                                        {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// always store new tensor in the smaller tensor index</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (tensor2Index &lt; tensor1Index){</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordtype">int</span> tensorIndexTmp = tensor1Index;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        tensor1Index = tensor2Index;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        tensor2Index = tensorIndexTmp;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> tensor1 = tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor1Index];</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> tensor2 = tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor2Index]; </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> outputTensor;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">int</span> numContractions = <a class="code" href="QuEST__tn_8c.html#a47c52a5805c348ef8517b3d91a760cdd">getNumContractions</a>(tn, tensor1Index, tensor2Index);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;numContractions: %d\n&quot;</span>, numContractions));</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">int</span> *tensor1Contractions, *tensor2Contractions; </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">int</span> *tensor1UncontractedVqs, *tensor2UncontractedVqs; </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">int</span> numTensor1UncontractedVqs=0, numTensor2UncontractedVqs=0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="QuEST__tn_8c.html#a0f0d16ecbd39a662bb17b21a6ba15d1b">getContractionVqIndices</a>(tn, tensor1Index, tensor2Index, numContractions, </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            &amp;tensor1Contractions, &amp;tensor2Contractions,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            &amp;numTensor1UncontractedVqs, &amp;numTensor2UncontractedVqs,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            &amp;tensor1UncontractedVqs, &amp;tensor2UncontractedVqs);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;tensor1Contractions: &quot;</span>));</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=0; p&lt;numContractions; p++) {<a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;%d &quot;</span>, tensor1Contractions[p])); }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;\ntensor2Contractions: &quot;</span>));</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=0; p&lt;numContractions; p++) {<a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;%d &quot;</span>, tensor2Contractions[p])); }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;\ntensor1UncontractedVqs: &quot;</span>));</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=0; p&lt;numTensor1UncontractedVqs; p++) {<a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;%d &quot;</span>, tensor1UncontractedVqs[p])); }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;\ntensor2UncontractedVqs: &quot;</span>));</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=0; p&lt;numTensor2UncontractedVqs; p++) {<a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;%d &quot;</span>, tensor2UncontractedVqs[p])); }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;\n&quot;</span>));</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">int</span> totalNumPq = tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> + tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">int</span> totalNumVq = numTensor1UncontractedVqs + numTensor2UncontractedVqs;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">int</span> totalNumQ = totalNumPq + totalNumVq;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> contractedStateVecSize, stateVec1Size, stateVec2Size, activeStateVec1Size, activeStateVec2Size;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> contractedIndex, stateVec1Index, stateVec2Index, activeStateVec1Index, activeStateVec2Index;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVec1PhysicalSize, stateVec2PhysicalSize;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    contractedStateVecSize = 1LL &lt;&lt; totalNumQ;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    stateVec1Size = 1LL &lt;&lt; tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> + tensor1.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    stateVec2Size = 1LL &lt;&lt; tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> + tensor1.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    stateVec1PhysicalSize = 1LL &lt;&lt; tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    stateVec2PhysicalSize = 1LL &lt;&lt; tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    activeStateVec1Size = stateVec1Size &gt;&gt; numContractions;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    activeStateVec2Size = stateVec2Size &gt;&gt; numContractions;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    Qureg contractedQureg = createQureg(totalNumQ, env);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    Qureg qureg1 = tensor1.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    Qureg qureg2 = tensor2.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    qreal sumReal, sumImag;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    qreal *stateVec1Real = qureg1.stateVec.real;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    qreal *stateVec1Imag = qureg1.stateVec.imag;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    qreal *stateVec2Real = qureg2.stateVec.real;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    qreal *stateVec2Imag = qureg2.stateVec.imag;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">for</span> (activeStateVec2Index=0; activeStateVec2Index&lt;activeStateVec2Size; activeStateVec2Index++) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">for</span> (activeStateVec1Index=0; activeStateVec1Index&lt;activeStateVec1Size; activeStateVec1Index++) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            stateVec1Index = <a class="code" href="QuEST__tn_8c.html#a3392b1ff25fb2f1f60cc7af272659b11">getStateVectorIndexFromActiveIndex</a>(activeStateVec1Index, tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    tensor1UncontractedVqs, numTensor1UncontractedVqs);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            stateVec2Index = <a class="code" href="QuEST__tn_8c.html#a3392b1ff25fb2f1f60cc7af272659b11">getStateVectorIndexFromActiveIndex</a>(activeStateVec2Index, tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    tensor2UncontractedVqs, numTensor2UncontractedVqs);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;-------------------------\n&quot;</span>));</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;t1: ai %lld si %lld\n&quot;</span>, activeStateVec1Index, stateVec1Index));</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;t2: ai %lld si %lld\n&quot;</span>, activeStateVec2Index, stateVec2Index));</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            Complex sum;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            sum = <a class="code" href="QuEST__tn_8c.html#a629ac80385cf6ba6b9067a99d23b9946">recursiveContract</a>(tensor1, tensor2, stateVec1Index, stateVec2Index, </div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                tensor1Contractions, tensor2Contractions, numContractions, 0);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            contractedIndex = <a class="code" href="QuEST__tn_8c.html#af01f5c813a7b9f00287fa5424284fcc9">getContractedIndex</a>(activeStateVec1Index, activeStateVec2Index, </div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    stateVec1PhysicalSize, stateVec2PhysicalSize, tensor1.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>, tensor2.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    numTensor1UncontractedVqs, numTensor2UncontractedVqs);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;OUTPUT: %lld VALUE: %f\n&quot;</span>, contractedIndex, sum.real));</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            contractedQureg.stateVec.real[contractedIndex] = sum.real;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            contractedQureg.stateVec.imag[contractedIndex] = sum.imag;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// Update vqVertices in tn lists</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    </div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// first tensor&#39;s vqVertices</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="structVqVertex.html">VqVertex</a> *tail=NULL;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">int</span> foundHead=0;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="QuEST__tn_8c.html#a4d0a76659767015c051ffc959e723693">removeContractedVqVertices</a>(tn, tensor1Index, tensor1Index, tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor1Index],</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            NULL, tensor1UncontractedVqs, numTensor1UncontractedVqs, &amp;tail, &amp;foundHead);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// second tensor&#39;s vqVertices</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (foundHead){</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">// there was at least one uncontracted index in the first tensor</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        tail-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor2Index];</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="QuEST__tn_8c.html#a4d0a76659767015c051ffc959e723693">removeContractedVqVertices</a>(tn, tensor2Index, tensor1Index, tail-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>, tail,</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                tensor2UncontractedVqs, numTensor2UncontractedVqs, &amp;tail, &amp;foundHead);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">// there were no uncontracted index in the first tensor</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="QuEST__tn_8c.html#a4d0a76659767015c051ffc959e723693">removeContractedVqVertices</a>(tn, tensor2Index, tensor1Index, tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor2Index], </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                NULL, tensor2UncontractedVqs, numTensor2UncontractedVqs, &amp;tail, &amp;foundHead);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> (!foundHead) tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[tensor1Index] = NULL;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[tensor1Index] = tail;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (tail != NULL) tail-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = NULL;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   </div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// Update first tensor </span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// The output of the contraction is stored in the location of the first tensor </span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// in the tensor array.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    destroyQureg(tensor1.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, env);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    outputTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a> = contractedQureg;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    outputTensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> = totalNumPq;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    outputTensor.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a> = totalNumVq;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    outputTensor.<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> = totalNumVq;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[tensor1Index] = totalNumVq;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor1Index] = outputTensor;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    </div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// Update second tensor</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// The order of tensors in the tensor array is not changed when two tensors are contracted</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// -- for now, just leave a gap where the second tensor was by setting numPq to 0.</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    destroyQureg(tensor2.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, env);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor2Index].<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> = 0;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[tensor2Index].<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a> = 0;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// Update tn mapping between global qubit indices and (tensor, local qubit index)</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="QuEST__tn_8c.html#a1d832a151f2596273ed4fcda5634ee53">remapTensorIndexFromGlobalPq</a>(tn);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="QuEST__tn_8c.html#a64f43b029eab36c891ccba576b009914">remapFirstGlobalPqIndex</a>(tn);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    </div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div><div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_af6551f0b4c3964c3128f808e7bf987c7"><div class="ttname"><a href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a></div><div class="ttdeci">#define DEBUG_PRINT(x)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00013">QuEST_tn.c:13</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a0f0d16ecbd39a662bb17b21a6ba15d1b"><div class="ttname"><a href="QuEST__tn_8c.html#a0f0d16ecbd39a662bb17b21a6ba15d1b">getContractionVqIndices</a></div><div class="ttdeci">void getContractionVqIndices(TensorNetwork tn, int tensor1Index, int tensor2Index, int numContractions, int **tensor1Contractions, int **tensor2Contractions, int *numTensor1UncontractedVqs, int *numTensor2UncontractedVqs, int **tensor1UncontractedVqs, int **tensor2UncontractedVqs)</div><div class="ttdoc">For a particular contraction of two tensors, generate the lists of virtual qubits that will be contra...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00074">QuEST_tn.c:74</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a47c52a5805c348ef8517b3d91a760cdd"><div class="ttname"><a href="QuEST__tn_8c.html#a47c52a5805c348ef8517b3d91a760cdd">getNumContractions</a></div><div class="ttdeci">int getNumContractions(TensorNetwork tn, int tensor1Index, int tensor2Index)</div><div class="ttdoc">Get the number of indices that will be contracted over when the two input tensors are contracted...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00041">QuEST_tn.c:41</a></div></div>
<div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a64f43b029eab36c891ccba576b009914"><div class="ttname"><a href="QuEST__tn_8c.html#a64f43b029eab36c891ccba576b009914">remapFirstGlobalPqIndex</a></div><div class="ttdeci">void remapFirstGlobalPqIndex(TensorNetwork tn)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00482">QuEST_tn.c:482</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a3392b1ff25fb2f1f60cc7af272659b11"><div class="ttname"><a href="QuEST__tn_8c.html#a3392b1ff25fb2f1f60cc7af272659b11">getStateVectorIndexFromActiveIndex</a></div><div class="ttdeci">long long int getStateVectorIndexFromActiveIndex(long long int activeStateIndex, int numPq, int *uncontractedVqs, int numUncontractedVqs)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00179">QuEST_tn.c:179</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="structTensor_html_aae8329bae4c7f141f77d5449617e3ce0"><div class="ttname"><a href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">Tensor::nextVqIndex</a></div><div class="ttdeci">int nextVqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00046">QuEST_tn.h:46</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structTensor_html_ab69644f02f0c6aad5483931e82d2fdd2"><div class="ttname"><a href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">Tensor::numVq</a></div><div class="ttdeci">int numVq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00044">QuEST_tn.h:44</a></div></div>
<div class="ttc" id="structTensorNetwork_html_af572173bbbd5831bafac1563fb42af61"><div class="ttname"><a href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">TensorNetwork::tensorTailVqVertex</a></div><div class="ttdeci">VqVertex ** tensorTailVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00054">QuEST_tn.h:54</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_af01f5c813a7b9f00287fa5424284fcc9"><div class="ttname"><a href="QuEST__tn_8c.html#af01f5c813a7b9f00287fa5424284fcc9">getContractedIndex</a></div><div class="ttdeci">long long int getContractedIndex(long long int activeStateVec1Index, long long int activeStateVec2Index, long long int stateVec1PhysicalSize, long long int stateVec2PhysicalSize, int numTensor1Pq, int numTensor2Pq, int numTensor1UncontractedVqs, int numTensor2UncontractedVqs)</div><div class="ttdoc">Get the index in the output state vector where an element resulting from a contraction between two te...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00128">QuEST_tn.c:128</a></div></div>
<div class="ttc" id="structTensor_html_a882c9fd399f54814efe79340fb90f23e"><div class="ttname"><a href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">Tensor::qureg</a></div><div class="ttdeci">Qureg qureg</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00042">QuEST_tn.h:42</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a4d0a76659767015c051ffc959e723693"><div class="ttname"><a href="QuEST__tn_8c.html#a4d0a76659767015c051ffc959e723693">removeContractedVqVertices</a></div><div class="ttdeci">void removeContractedVqVertices(TensorNetwork tn, int tensorIndex, int newTensorIndex, VqVertex *startingVqVertex, VqVertex *prevVqVertexToKeep, int *uncontractedVqs, int numUncontractedVqs, VqVertex **tail, int *foundHead)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00501">QuEST_tn.c:501</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a629ac80385cf6ba6b9067a99d23b9946"><div class="ttname"><a href="QuEST__tn_8c.html#a629ac80385cf6ba6b9067a99d23b9946">recursiveContract</a></div><div class="ttdeci">Complex recursiveContract(Tensor tensor1, Tensor tensor2, long long int tensor1Offset, long long int tensor2Offset, int *tensor1Contractions, int *tensor2Contractions, int numContractions, int vqIndex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00202">QuEST_tn.c:202</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a1d832a151f2596273ed4fcda5634ee53"><div class="ttname"><a href="QuEST__tn_8c.html#a1d832a151f2596273ed4fcda5634ee53">remapTensorIndexFromGlobalPq</a></div><div class="ttdeci">void remapTensorIndexFromGlobalPq(TensorNetwork tn)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00471">QuEST_tn.c:471</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8eb46e2a13b03f3dc171437eec5e54a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eb46e2a13b03f3dc171437eec5e54a5">&#9670;&nbsp;</a></span>createTensorNetwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a> createTensorNetwork </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numTensors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numPqPerTensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numVqPerTensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuESTEnv&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory for and initialize a new tensor network object given the number of physical qubits and maximum number of virtual qubits in each tensor. </p>
<p>Initialise all physical qubits to the zero state and virtual qubits to an undefined state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>numTensors the number of tensors in the tensor network </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int*</td><td>numPqPerTensor an array of values corresponding to the number of physical qubits in each tensor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int*</td><td>numVqPerTensor an array of values corresponding to the maximum number of virtual qubits that could be used in each tensor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">QuESTEnv</td><td>env QuEST environment object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00403">403</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00045">Tensor::firstGlobalPqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00046">Tensor::nextVqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00050">TensorNetwork::numTensors</a>, <a class="el" href="QuEST__tn_8h_source.html#l00044">Tensor::numVq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00042">Tensor::qureg</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00052">TensorNetwork::tensorIndexFromGlobalPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00054">TensorNetwork::tensorTailVqVertex</a>.</p>

<p class="reference">Referenced by <a class="el" href="testCircuit1_8c_source.html#l00006">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                     {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="structTensorNetwork.html">TensorNetwork</a> tn;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a> = numTensors;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// allocate memory in tensor object</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a> = malloc( numTensors*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>)) );</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a> = malloc( numTensors*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>)) );</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a> = malloc( numTensors*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>)) );</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a> = malloc( numTensors*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>)) );</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// calculate total number of qubits in system for qubits given per tensor</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">int</span> numTotalPq = 0;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">int</span> numTotalVq = 0;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numTensors; i++){</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        numTotalPq += numPqPerTensor[i];</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        numTotalVq += numVqPerTensor[i];</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    tn.<a class="code" href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">tensorIndexFromGlobalPq</a> = malloc( numTotalPq*<span class="keyword">sizeof</span>(*(tn.<a class="code" href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">tensorIndexFromGlobalPq</a>)) );</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// populate tensorIndexFromGlobalPq array. This contains duplicated values but should be</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// fast to look up</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">int</span> currentPq = 0;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numTensors; i++){</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordtype">int</span> numPqInCurrentTensor = numPqPerTensor[i];</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;numPqInCurrentTensor; j++){</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            tn.<a class="code" href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">tensorIndexFromGlobalPq</a>[currentPq++] = i;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">int</span> globalPqOffset = 0;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// populate tensor array</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> tmpTensor;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numTensors; i++){</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> = numPqPerTensor[i];</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a> = numVqPerTensor[i];</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">// create qureg object and initialize to zero</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a> = createQureg(tmpTensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a> + tmpTensor.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a>, env);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        initZeroState(tmpTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">//if (i==0)statevec_initStateDebugFromOffset(tmpTensor.qureg, 0);</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">//if (i==1) hadamard(tmpTensor.qureg, 0);</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">//if (i==1) rotateZ(tmpTensor.qureg, 0, 0.3);</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="comment">//if (i==0) hadamard(tmpTensor.qureg, 0);</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> (i==0) pauliX(tmpTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, 0);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span> (i==0) rotateZ(tmpTensor.<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, 0, 0.3);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">//if (i==1)statevec_initStateDebugFromOffset(tmpTensor.qureg, 2);</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">// for quick conversion to local index from global index</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#aa3ed3b76e597c63a6146b666d241398d">firstGlobalPqIndex</a> = globalPqOffset;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">// the next virtual qubit to use</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        tmpTensor.<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> = 0;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[i] = tmpTensor;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[i] = NULL;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[i] = NULL;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[i] = 0;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        globalPqOffset += tmpTensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> tn;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div><div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad1bda148e46aac689b7a2cb9265d0390"><div class="ttname"><a href="structTensorNetwork.html#ad1bda148e46aac689b7a2cb9265d0390">TensorNetwork::tensorIndexFromGlobalPq</a></div><div class="ttdeci">int * tensorIndexFromGlobalPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00052">QuEST_tn.h:52</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="structTensor_html_aae8329bae4c7f141f77d5449617e3ce0"><div class="ttname"><a href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">Tensor::nextVqIndex</a></div><div class="ttdeci">int nextVqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00046">QuEST_tn.h:46</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad46c386a71fed70e88cfa327871eaa90"><div class="ttname"><a href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">TensorNetwork::numTensors</a></div><div class="ttdeci">int numTensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00050">QuEST_tn.h:50</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structTensor_html_ab69644f02f0c6aad5483931e82d2fdd2"><div class="ttname"><a href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">Tensor::numVq</a></div><div class="ttdeci">int numVq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00044">QuEST_tn.h:44</a></div></div>
<div class="ttc" id="structTensorNetwork_html_af572173bbbd5831bafac1563fb42af61"><div class="ttname"><a href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">TensorNetwork::tensorTailVqVertex</a></div><div class="ttdeci">VqVertex ** tensorTailVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00054">QuEST_tn.h:54</a></div></div>
<div class="ttc" id="structTensor_html_a882c9fd399f54814efe79340fb90f23e"><div class="ttname"><a href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">Tensor::qureg</a></div><div class="ttdeci">Qureg qureg</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00042">QuEST_tn.h:42</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
<div class="ttc" id="structTensor_html_aa3ed3b76e597c63a6146b666d241398d"><div class="ttname"><a href="structTensor.html#aa3ed3b76e597c63a6146b666d241398d">Tensor::firstGlobalPqIndex</a></div><div class="ttdeci">int firstGlobalPqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00045">QuEST_tn.h:45</a></div></div>
<div class="ttc" id="structTensorNetwork_html"><div class="ttname"><a href="structTensorNetwork.html">TensorNetwork</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00049">QuEST_tn.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25f06328d45b2f509185b89773c9163e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25f06328d45b2f509185b89773c9163e">&#9670;&nbsp;</a></span>printTensorNetwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printTensorNetwork </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print all tensors in a tensor network and their entanglement with other tensors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn the tensor network to print </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00677">677</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8h_source.html#l00037">VqVertex::entangledPair</a>, <a class="el" href="QuEST__tn_8c_source.html#l00666">getVqVertexIndex()</a>, <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00050">TensorNetwork::numTensors</a>, <a class="el" href="QuEST__tn_8h_source.html#l00044">Tensor::numVq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00038">VqVertex::tensorIndex</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>.</p>

<p class="reference">Referenced by <a class="el" href="testCircuit1_8c_source.html#l00006">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                         {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    printf(<span class="stringliteral">&quot;\n----- TensorNetwork -------------------- \n&quot;</span>);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    printf(<span class="stringliteral">&quot;%d tensors\n&quot;</span>, tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a>);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;tn.<a class="code" href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">numTensors</a>; i++){</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="structTensor.html">Tensor</a> tensor = tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[i];</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">if</span> (tensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>==0){</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            printf(<span class="stringliteral">&quot;Tensor %d: DELETED BY CONTRACTION\n&quot;</span>, i);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            printf(<span class="stringliteral">&quot;Tensor %d: %d physical qubits, %d virtual qubits\n&quot;</span>, i, tensor.<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>, tensor.<a class="code" href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">numVq</a>);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            printf(<span class="stringliteral">&quot;\t%d Entanglements:\n&quot;</span>, tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[i]);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            </div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="structVqVertex.html">VqVertex</a> *vqVertex = tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[i];</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <a class="code" href="structVqVertex.html">VqVertex</a> *entangledPair;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordtype">int</span> vqCount=0;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">while</span> (vqVertex != NULL){</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                entangledPair = vqVertex-&gt;<a class="code" href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">entangledPair</a>;  </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                <span class="keywordtype">int</span> entangledIndex = <a class="code" href="QuEST__tn_8c.html#af429a9a3a19a3c1b0f11a09326b5846f">getVqVertexIndex</a>(tn, entangledPair);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                printf(<span class="stringliteral">&quot;\t\tVirtual qubit %d -&gt; tensor %d, virtual qubit %d\n&quot;</span>, </div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        vqCount++, entangledPair-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a>, entangledIndex);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                vqVertex = vqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">//    printf(&quot;\n--------------------------------------- \n&quot;);</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div><div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="structVqVertex_html_ab438ef9b43dc229425f893ae67ff34ba"><div class="ttname"><a href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">VqVertex::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00038">QuEST_tn.h:38</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="structVqVertex_html_a02e9d4de4db65179cb5eaa26df10a138"><div class="ttname"><a href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">VqVertex::entangledPair</a></div><div class="ttdeci">struct VqVertex * entangledPair</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00037">QuEST_tn.h:37</a></div></div>
<div class="ttc" id="structTensorNetwork_html_ad46c386a71fed70e88cfa327871eaa90"><div class="ttname"><a href="structTensorNetwork.html#ad46c386a71fed70e88cfa327871eaa90">TensorNetwork::numTensors</a></div><div class="ttdeci">int numTensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00050">QuEST_tn.h:50</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structTensor_html_ab69644f02f0c6aad5483931e82d2fdd2"><div class="ttname"><a href="structTensor.html#ab69644f02f0c6aad5483931e82d2fdd2">Tensor::numVq</a></div><div class="ttdeci">int numVq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00044">QuEST_tn.h:44</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_af429a9a3a19a3c1b0f11a09326b5846f"><div class="ttname"><a href="QuEST__tn_8c.html#af429a9a3a19a3c1b0f11a09326b5846f">getVqVertexIndex</a></div><div class="ttdeci">int getVqVertexIndex(TensorNetwork tn, VqVertex *vqVertex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00666">QuEST_tn.c:666</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac72c327e053be69896f5660f5655e59c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac72c327e053be69896f5660f5655e59c">&#9670;&nbsp;</a></span>tn_controlledNot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tn_controlledNot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate on qubits in a tensor network. </p>
<p>If the two qubits are in different tensors, also track the entanglement introduced between those tensors using virtual qubits.</p>
<p>Note that the control and target qubits should be supplied as global qubit indices over all physical qubits in all tensors.</p>
<p>This applies pauliX to the target qubit if the control qubit has value 1. This effects the two-qubit unitary </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; &amp; 1 \\ &amp; &amp; 1 \end{pmatrix} \]" src="form_0.png"/>
</p>
<p> on the control and target qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, -.5); \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \end{tikzpicture} } \]" src="form_1.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname"><a class="el" href="structTensorNetwork.html">TensorNetwork</a></td><td>tn the tensor network containing the control and target qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>nots the target if this qubit is 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to not </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>qureg.numQubitsRepresented</code>), or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__tn_8c_source.html#l00549">549</a> of file <a class="el" href="QuEST__tn_8c_source.html">QuEST_tn.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__tn_8c_source.html#l00013">DEBUG_PRINT</a>, <a class="el" href="QuEST__tn_8h_source.html#l00037">VqVertex::entangledPair</a>, <a class="el" href="QuEST__tn_8c_source.html#l00657">getLocalPq()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00620">initVirtualControl()</a>, <a class="el" href="QuEST__tn_8c_source.html#l00614">initVirtualTarget()</a>, <a class="el" href="QuEST__tn_8h_source.html#l00036">VqVertex::nextInTensor</a>, <a class="el" href="QuEST__tn_8h_source.html#l00046">Tensor::nextVqIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00055">TensorNetwork::numEntanglements</a>, <a class="el" href="QuEST__tn_8h_source.html#l00043">Tensor::numPq</a>, <a class="el" href="QuEST__tn_8h_source.html#l00032">QCoord::qIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00042">Tensor::qureg</a>, <a class="el" href="QuEST__tn_8h_source.html#l00053">TensorNetwork::tensorHeadVqVertex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00031">QCoord::tensorIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00038">VqVertex::tensorIndex</a>, <a class="el" href="QuEST__tn_8h_source.html#l00051">TensorNetwork::tensors</a>, and <a class="el" href="QuEST__tn_8h_source.html#l00054">TensorNetwork::tensorTailVqVertex</a>.</p>

<p class="reference">Referenced by <a class="el" href="testCircuit1_8c_source.html#l00006">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                                                                      {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="structQCoord.html">QCoord</a> controlPqLocal = <a class="code" href="QuEST__tn_8c.html#ac6ac2be8a3e7da5fc5855a3b0b0656b7">getLocalPq</a>(tn, controlQubit);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="structQCoord.html">QCoord</a> targetPqLocal = <a class="code" href="QuEST__tn_8c.html#ac6ac2be8a3e7da5fc5855a3b0b0656b7">getLocalPq</a>(tn, targetQubit);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="structTensor.html">Tensor</a> *controlTensor = &amp;(tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a> == targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>){</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="comment">// qubits are in same tensor/qureg. Just do a normal qureg operation</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        controlledNot(controlTensor-&gt;<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, controlPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>, targetPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="comment">// qubits are in different tensor/qureg</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">// do control tensor half</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">// TODO: note this won&#39;t work if doing multiple different operations on the same tensor in parallel </span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordtype">int</span> virtualTargetIndex = controlTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">// TODO -- shouldn&#39;t have to initialize virtual target when virtual qubits are</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="comment">// automatically initialized in the zero state</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="QuEST__tn_8c.html#ac981843cd91f909690681de3eb5e8a64">initVirtualTarget</a>(*controlTensor, virtualTargetIndex + controlTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        controlTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> = controlTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> + 1;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;controlled not 1: %d %d\n&quot;</span>, controlPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>, virtualTargetIndex + controlTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>));</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        controlledNot(controlTensor-&gt;<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, controlPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>, virtualTargetIndex + controlTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">// do target tensor half</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">// TODO: note this won&#39;t work if doing multiple different operations on the same tensor in parallel </span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="structTensor.html">Tensor</a> *targetTensor = &amp;(tn.<a class="code" href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">tensors</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordtype">int</span> virtualControlIndex = targetTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <a class="code" href="QuEST__tn_8c.html#a502a2f31cd89e3e8ad3148f2de2ac346">initVirtualControl</a>(*targetTensor, virtualControlIndex + targetTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        targetTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> = targetTensor-&gt;<a class="code" href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">nextVqIndex</a> + 1;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <a class="code" href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a>((<span class="stringliteral">&quot;controlled not 2: %d %d\n&quot;</span>, virtualControlIndex + targetTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>, targetPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        controlledNot(targetTensor-&gt;<a class="code" href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">qureg</a>, virtualControlIndex + targetTensor-&gt;<a class="code" href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">numPq</a>, targetPqLocal.<a class="code" href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">qIndex</a>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;     </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">// TODO -- change t1, t2 to control/target </span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment">// update adjacency list. </span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="comment">// tensor1</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="structVqVertex.html">VqVertex</a> *tensor1VqVertex = malloc(<span class="keyword">sizeof</span>(*tensor1VqVertex));</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        tensor1VqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = NULL;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        tensor1VqVertex-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a> = targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">if</span> (tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] != NULL){</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = tensor1VqVertex;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] = tensor1VqVertex;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">if</span> (tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]==0) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] = tensor1VqVertex;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">// tensor2</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="structVqVertex.html">VqVertex</a> *tensor2VqVertex = malloc(<span class="keyword">sizeof</span>(*tensor2VqVertex));</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        tensor2VqVertex-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = NULL;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        tensor2VqVertex-&gt;<a class="code" href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">tensorIndex</a> = controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">if</span> (tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] != NULL){</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]-&gt;<a class="code" href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">nextInTensor</a> = tensor2VqVertex;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">tensorTailVqVertex</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] = tensor2VqVertex;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">if</span> (tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]==0) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            tn.<a class="code" href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">tensorHeadVqVertex</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>] = tensor2VqVertex;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        tensor1VqVertex-&gt;<a class="code" href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">entangledPair</a> = tensor2VqVertex;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        tensor2VqVertex-&gt;<a class="code" href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">entangledPair</a> = tensor1VqVertex;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[controlPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]++;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        tn.<a class="code" href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">numEntanglements</a>[targetPqLocal.<a class="code" href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">tensorIndex</a>]++;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div><div class="ttc" id="structQCoord_html"><div class="ttname"><a href="structQCoord.html">QCoord</a></div><div class="ttdoc">Naming conventions: </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00030">QuEST_tn.h:30</a></div></div>
<div class="ttc" id="structTensor_html"><div class="ttname"><a href="structTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00041">QuEST_tn.h:41</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_af6551f0b4c3964c3128f808e7bf987c7"><div class="ttname"><a href="QuEST__tn_8c.html#af6551f0b4c3964c3128f808e7bf987c7">DEBUG_PRINT</a></div><div class="ttdeci">#define DEBUG_PRINT(x)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00013">QuEST_tn.c:13</a></div></div>
<div class="ttc" id="structVqVertex_html_a2ef8bc44180e394d2c07596df7d580aa"><div class="ttname"><a href="structVqVertex.html#a2ef8bc44180e394d2c07596df7d580aa">VqVertex::nextInTensor</a></div><div class="ttdeci">struct VqVertex * nextInTensor</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00036">QuEST_tn.h:36</a></div></div>
<div class="ttc" id="structVqVertex_html"><div class="ttname"><a href="structVqVertex.html">VqVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00035">QuEST_tn.h:35</a></div></div>
<div class="ttc" id="structVqVertex_html_ab438ef9b43dc229425f893ae67ff34ba"><div class="ttname"><a href="structVqVertex.html#ab438ef9b43dc229425f893ae67ff34ba">VqVertex::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00038">QuEST_tn.h:38</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a7c5bfe4e727360b11cc9c293f747dc43"><div class="ttname"><a href="structTensorNetwork.html#a7c5bfe4e727360b11cc9c293f747dc43">TensorNetwork::numEntanglements</a></div><div class="ttdeci">int * numEntanglements</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00055">QuEST_tn.h:55</a></div></div>
<div class="ttc" id="structTensor_html_a0af0a8ebf1fffeed1d3f0a3e30463b4e"><div class="ttname"><a href="structTensor.html#a0af0a8ebf1fffeed1d3f0a3e30463b4e">Tensor::numPq</a></div><div class="ttdeci">int numPq</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00043">QuEST_tn.h:43</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_a502a2f31cd89e3e8ad3148f2de2ac346"><div class="ttname"><a href="QuEST__tn_8c.html#a502a2f31cd89e3e8ad3148f2de2ac346">initVirtualControl</a></div><div class="ttdeci">void initVirtualControl(Tensor tensor, int vqIndex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00620">QuEST_tn.c:620</a></div></div>
<div class="ttc" id="structVqVertex_html_a02e9d4de4db65179cb5eaa26df10a138"><div class="ttname"><a href="structVqVertex.html#a02e9d4de4db65179cb5eaa26df10a138">VqVertex::entangledPair</a></div><div class="ttdeci">struct VqVertex * entangledPair</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00037">QuEST_tn.h:37</a></div></div>
<div class="ttc" id="structTensor_html_aae8329bae4c7f141f77d5449617e3ce0"><div class="ttname"><a href="structTensor.html#aae8329bae4c7f141f77d5449617e3ce0">Tensor::nextVqIndex</a></div><div class="ttdeci">int nextVqIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00046">QuEST_tn.h:46</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_ac6ac2be8a3e7da5fc5855a3b0b0656b7"><div class="ttname"><a href="QuEST__tn_8c.html#ac6ac2be8a3e7da5fc5855a3b0b0656b7">getLocalPq</a></div><div class="ttdeci">QCoord getLocalPq(TensorNetwork tn, int globalPq)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00657">QuEST_tn.c:657</a></div></div>
<div class="ttc" id="structTensorNetwork_html_adadf11d65145190441a41af1676e2c9b"><div class="ttname"><a href="structTensorNetwork.html#adadf11d65145190441a41af1676e2c9b">TensorNetwork::tensors</a></div><div class="ttdeci">Tensor * tensors</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00051">QuEST_tn.h:51</a></div></div>
<div class="ttc" id="structQCoord_html_a7e5ae8370feb6e053cf69429fcc1e1e1"><div class="ttname"><a href="structQCoord.html#a7e5ae8370feb6e053cf69429fcc1e1e1">QCoord::tensorIndex</a></div><div class="ttdeci">int tensorIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00031">QuEST_tn.h:31</a></div></div>
<div class="ttc" id="structTensorNetwork_html_af572173bbbd5831bafac1563fb42af61"><div class="ttname"><a href="structTensorNetwork.html#af572173bbbd5831bafac1563fb42af61">TensorNetwork::tensorTailVqVertex</a></div><div class="ttdeci">VqVertex ** tensorTailVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00054">QuEST_tn.h:54</a></div></div>
<div class="ttc" id="structTensor_html_a882c9fd399f54814efe79340fb90f23e"><div class="ttname"><a href="structTensor.html#a882c9fd399f54814efe79340fb90f23e">Tensor::qureg</a></div><div class="ttdeci">Qureg qureg</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00042">QuEST_tn.h:42</a></div></div>
<div class="ttc" id="structTensorNetwork_html_a884d1989bf632e3b14df2d76cb5a35e5"><div class="ttname"><a href="structTensorNetwork.html#a884d1989bf632e3b14df2d76cb5a35e5">TensorNetwork::tensorHeadVqVertex</a></div><div class="ttdeci">VqVertex ** tensorHeadVqVertex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00053">QuEST_tn.h:53</a></div></div>
<div class="ttc" id="QuEST__tn_8c_html_ac981843cd91f909690681de3eb5e8a64"><div class="ttname"><a href="QuEST__tn_8c.html#ac981843cd91f909690681de3eb5e8a64">initVirtualTarget</a></div><div class="ttdeci">void initVirtualTarget(Tensor tensor, int vqIndex)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8c_source.html#l00614">QuEST_tn.c:614</a></div></div>
<div class="ttc" id="structQCoord_html_a5c503116e9f5043a50a00a90bacdb032"><div class="ttname"><a href="structQCoord.html#a5c503116e9f5043a50a00a90bacdb032">QCoord::qIndex</a></div><div class="ttdeci">int qIndex</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__tn_8h_source.html#l00032">QuEST_tn.h:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a11972021bb4e110960b143c8d13e9a92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11972021bb4e110960b143c8d13e9a92">&#9670;&nbsp;</a></span>tn_unitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tn_unitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structTensorNetwork.html">TensorNetwork</a>&#160;</td>
          <td class="paramname"><em>tn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexMatrix2&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a general single-qubit unitary (including a global phase factor). </p>
<p>The passed 2x2 ComplexMatrix must be unitary, otherwise an error is thrown.</p>
<p>Note that the target qubit should be supplied as a global qubit index over all physical qubits in all tensors.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_2.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>targetQubit</code> is outside [0, <code>qureg.numQubitsRepresented</code>), or matrix <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 17 2019 15:05:20 for Quantum Exact Simulation Toolkit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
